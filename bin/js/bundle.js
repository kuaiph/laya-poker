var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**This class is automatically generated by LayaAirIDE, please do not make any modifications. */


var _GameView = require("./view/GameView");

var _GameView2 = _interopRequireDefault(_GameView);

var _Seat = require("./sprite/Seat");

var _Seat2 = _interopRequireDefault(_Seat);

var _Start = require("./sprite/Start");

var _Start2 = _interopRequireDefault(_Start);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var GameConfig = function () {
    function GameConfig() {
        _classCallCheck(this, GameConfig);
    }

    _createClass(GameConfig, null, [{
        key: "init",
        value: function init() {
            //注册Script或者Runtime引用
            var reg = Laya.ClassUtils.regClass;
            reg("view/GameView.js", _GameView2.default);
            reg("sprite/Seat.js", _Seat2.default);
            reg("sprite/Start.js", _Start2.default);
        }
    }]);

    return GameConfig;
}();

exports.default = GameConfig;

GameConfig.width = 370;
GameConfig.height = 658;
GameConfig.scaleMode = "showall";
GameConfig.screenMode = "none";
GameConfig.alignV = "middle";
GameConfig.alignH = "center";
GameConfig.startScene = "Start.scene";
GameConfig.sceneRoot = "";
GameConfig.debug = false;
GameConfig.stat = false;
GameConfig.physicsDebug = false;
GameConfig.exportSceneToJson = true;

GameConfig.init();

},{"./sprite/Seat":4,"./sprite/Start":5,"./view/GameView":7}],2:[function(require,module,exports){
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _GameConfig = require('./GameConfig');

var _GameConfig2 = _interopRequireDefault(_GameConfig);

var _WebSocket = require('./util/WebSocket');

var _WebSocket2 = _interopRequireDefault(_WebSocket);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Main = function () {
    function Main() {
        _classCallCheck(this, Main);

        //根据IDE设置初始化引擎
        if (window["Laya3D"]) Laya3D.init(_GameConfig2.default.width, _GameConfig2.default.height);else Laya.init(_GameConfig2.default.width, _GameConfig2.default.height, Laya["WebGL"]);
        Laya["Physics"] && Laya["Physics"].enable();
        Laya["DebugPanel"] && Laya["DebugPanel"].enable();
        Laya.stage.scaleMode = _GameConfig2.default.scaleMode;
        Laya.stage.screenMode = _GameConfig2.default.screenMode;
        Laya.stage.alignV = _GameConfig2.default.alignV;
        Laya.stage.alignH = _GameConfig2.default.alignH;
        //兼容微信不支持加载scene后缀场景
        Laya.URL.exportSceneToJson = _GameConfig2.default.exportSceneToJson;

        //打开调试面板（通过IDE设置调试模式，或者url地址增加debug=true参数，均可打开调试面板）
        if (_GameConfig2.default.debug || Laya.Utils.getQueryString("debug") == "true") Laya.enableDebugPanel();
        if (_GameConfig2.default.physicsDebug && Laya["PhysicsDebugDraw"]) Laya["PhysicsDebugDraw"].enable();
        if (_GameConfig2.default.stat) Laya.Stat.show();
        Laya.alertGlobalError = true;

        //激活资源版本控制，version.json由IDE发布功能自动生成，如果没有也不影响后续流程
        Laya.ResourceVersion.enable("version.json", Laya.Handler.create(this, this.onVersionLoaded), Laya.ResourceVersion.FILENAME_VERSION);
        //加载网络连接
        new _WebSocket2.default().init();
    }

    _createClass(Main, [{
        key: 'onVersionLoaded',
        value: function onVersionLoaded() {
            //激活大小图映射，加载小图的时候，如果发现小图在大图合集里面，则优先加载大图合集，而不是小图
            Laya.AtlasInfoManager.enable("fileconfig.json", Laya.Handler.create(this, this.onConfigLoaded));
        }
    }, {
        key: 'onConfigLoaded',
        value: function onConfigLoaded() {
            //加载IDE指定的场景
            _GameConfig2.default.startScene && Laya.Scene.open(_GameConfig2.default.startScene);
            // beginLoad()
        }
        // // 加载资源
        // beginLoad() {
        //     // 加载图集
        //     Laya.loader.load("res/atlas/ui.atlas", Laya.Handler.create(this, this.onLoaded), null, Laya.Loader.ATLAS)
        //     // 播放背景音乐
        //     // Laya.SoundManager.playMusic("res/sounds/bgm.mp3", 0, null)
        // }
        // // 加载完成回调
        // onLoaded() {
        //     // 启动游戏界面
        //     LayaApp.gameView = new GameView()
        //     Laya.stage.addChild(LayaApp.gameView)
        //     // LayaApp.gameStartView = new GameStartView()
        //     // Laya.stage.addChild(LayaApp.gameStartView)
        // }

    }]);

    return Main;
}();

//激活启动类


new Main();

},{"./GameConfig":1,"./util/WebSocket":6}],3:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/**
 * 扑克类
 */
var Poker = function () {
    function Poker(inparam) {
        _classCallCheck(this, Poker);

        this.pokerImg = inparam.pokerImg;
        this.seatImg = inparam.seatImg;
        this.dataPoker = inparam.dataPoker;
        this.isMe = false;
        // this.reset()
    }
    // 重置


    _createClass(Poker, [{
        key: 'reset',
        value: function reset() {}
        // 隐藏

    }, {
        key: 'hide',
        value: function hide() {
            this.pokerImg.visible = false;
        }
        // 发牌

    }, {
        key: 'send',
        value: function send(pokerSentIndex) {
            this.isMe = this.seatImg.name == 'seat0' ? true : false;
            var x = this.seatImg.x;
            if (this.isMe) {
                pokerSentIndex == 0 ? x += 50 : x += 100;
            }
            Laya.Tween.to(this.pokerImg, { x: x, y: this.seatImg.y }, 500, Laya.Ease.strongOut, Laya.Handler.create(this, this.sendComplete));
        }
        // 手牌发牌完成

    }, {
        key: 'sendComplete',
        value: function sendComplete() {
            if (!this.isMe) {
                this.pokerImg.visible = false;
            } else {
                this.pokerImg.skin = 'ui/' + this.dataPoker.card + '.png';
            }
        }
        // 发公共牌

    }, {
        key: 'sendPublic',
        value: function sendPublic(publicIndex) {
            var x = this.pokerImg.x;
            var y = this.pokerImg.y + 80;
            switch (publicIndex) {
                case 0:
                    x -= 110;
                    break;
                case 1:
                    x -= 55;
                    break;
                case 2:
                    break;
                case 3:
                    x += 55;
                    break;
                case 4:
                    x += 110;
                    break;
                default:
                    break;
            }
            Laya.Tween.to(this.pokerImg, { x: x, y: y }, 500, Laya.Ease.strongOut, Laya.Handler.create(this, this.sendPublicComplete));
        }
        // 公牌发牌完成

    }, {
        key: 'sendPublicComplete',
        value: function sendPublicComplete() {
            this.pokerImg.skin = 'ui/' + this.dataPoker.card + '.png';
        }
    }]);

    return Poker;
}();

exports.default = Poker;

},{}],4:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var Start = function (_Laya$Script) {
    _inherits(Start, _Laya$Script);

    function Start() {
        _classCallCheck(this, Start);

        return _possibleConstructorReturn(this, (Start.__proto__ || Object.getPrototypeOf(Start)).apply(this, arguments));
    }

    _createClass(Start, [{
        key: 'onEnable',
        value: function onEnable() {}
    }, {
        key: 'onClick',
        value: function onClick() {
            // console.log(this)
            console.log(this.owner.name);
            this.owner.skin = 'ui/person.png';
        }
    }]);

    return Start;
}(Laya.Script);

exports.default = Start;

},{}],5:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var Start = function (_Laya$Script) {
    _inherits(Start, _Laya$Script);

    function Start() {
        _classCallCheck(this, Start);

        return _possibleConstructorReturn(this, (Start.__proto__ || Object.getPrototypeOf(Start)).apply(this, arguments));
    }

    _createClass(Start, [{
        key: 'onEnable',
        value: function onEnable() {}
    }, {
        key: 'onClick',
        value: function onClick() {
            Laya.Scene.open('Game.scene');
        }
    }]);

    return Start;
}(Laya.Script);

exports.default = Start;

},{}],6:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/**
 * 网络长连接类
 */
var WebSocket = function () {
    function WebSocket() {
        _classCallCheck(this, WebSocket);

        WebSocket.instance = this;
        // 长连接服务器
        WebSocket.socket = new Laya.Socket();
        WebSocket.socket.endian = Laya.Byte.LITTLE_ENDIAN; //采用小端
    }

    _createClass(WebSocket, [{
        key: 'init',
        value: function init() {
            var _this = this;

            WebSocket.socket.connectByUrl('ws://localhost:5000/socket/poker');
            WebSocket.socket.on(Laya.Event.OPEN, this, function (e) {
                console.log('连接建立');
            });
            WebSocket.socket.on(Laya.Event.CLOSE, this, function (e) {
                console.log('连接关闭');
            });
            WebSocket.socket.on(Laya.Event.ERROR, this, function (e) {
                console.error('连接出错');
            });
            // 封装发送数据方法
            WebSocket.send = function (req) {
                // try {
                return new Promise(function (resolve, reject) {
                    WebSocket.socket.send(JSON.stringify(req));
                    // 返回数据
                    WebSocket.socket.on(Laya.Event.MESSAGE, _this, function (res) {
                        res = JSON.parse(res);
                        if (req.method == res.method) {
                            resolve(res);
                        }
                    });
                });
                // } catch (error) {
                //     setTimeout(() => {
                //         console.log(`重试发送：${data}`)
                //         WebSocket.send(data)
                //     }, 500)
                // }
            };
        }
    }]);

    return WebSocket;
}();

exports.default = WebSocket;

},{}],7:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _WebSocket = require('../util/WebSocket');

var _WebSocket2 = _interopRequireDefault(_WebSocket);

var _Poker = require('../sprite/Poker');

var _Poker2 = _interopRequireDefault(_Poker);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

/**
 * 游戏主界面类
 * 载入扑克桌
 */
var GameView = function (_Laya$Scene) {
    _inherits(GameView, _Laya$Scene);

    function GameView() {
        _classCallCheck(this, GameView);

        //设置单例的引用方式，方便其他类引用
        var _this = _possibleConstructorReturn(this, (GameView.__proto__ || Object.getPrototypeOf(GameView)).call(this));

        GameView.instance = _this;
        _this.seatCount = 9; // 座位数量    
        _this.seats = []; // 座位数组           
        _this.pokers = []; // 扑克牌数组
        _this.pokerSentIndex = 0; // 已发牌索引
        _this.pokerHandCount = _this.seatCount * 2; // 手牌数量
        _this.pokerCount = _this.pokerHandCount + 5; // 所有牌数量
        _this.chip2Index = 0; // 大盲位索引
        return _this;
    }

    _createClass(GameView, [{
        key: 'onEnable',
        value: function onEnable() {
            // 初始化
            this.init();
        }
    }, {
        key: 'onClosed',
        value: function onClosed() {
            _WebSocket2.default.socket.close();
        }
        // 初始化

    }, {
        key: 'init',
        value: function init() {
            var _this2 = this;

            // 初始化桌位
            for (var i = 0; i < this.seatCount; i++) {
                this.seats.push(this.getChildByName('seat' + i));
            }
            // 初始化牌组
            _WebSocket2.default.send({ method: 'SEND_CARD', count: this.pokerCount }).then(function (data) {
                for (var _i = 0; _i < data.pokers.length; _i++) {
                    var poker = {};
                    // 手牌
                    if (_i < _this2.pokerHandCount) {
                        poker = new _Poker2.default({ pokerImg: _this2.getChildByName('poker' + _i), seatImg: _this2.seats[_i % _this2.seatCount], dataPoker: data.pokers[_i] });
                    }
                    // 公牌
                    else {
                            poker = new _Poker2.default({ pokerImg: _this2.getChildByName('poker' + _i), dataPoker: data.pokers[_i] });
                        }
                    _this2.pokers.push(poker);
                }
                // 启动游戏
                _this2.gameStart();
            });
            // 加载鼠标点击事件
            Laya.stage.on(Laya.Event.MOUSE_DOWN, this, this.onMouseDown);
        }
        // 游戏启动

    }, {
        key: 'gameStart',
        value: function gameStart() {
            // 每人发两张牌
            Laya.timer.loop(300, this, this.onSendPoker); // 每300毫循环一次
            // Laya.timer.frameLoop(10, this, this.onLoop) // 每10帧循环一次
        }
        // 发牌

    }, {
        key: 'onSendPoker',
        value: function onSendPoker() {
            this.pokers[this.pokerSentIndex].send(this.pokerSentIndex);
            this.pokerSentIndex++;
            // 手牌发牌结束
            if (this.pokerSentIndex == this.pokerHandCount) {
                // 隐藏剩余牌，为展开公牌做准备
                // for (let i = this.pokerSentIndex + 1; i <= 22; i++) {
                //     this.pokers[i].hide()
                // }
                Laya.timer.clear(this, this.onSendPoker);
            }
        }

        // 鼠标点击事件

    }, {
        key: 'onMouseDown',
        value: function onMouseDown() {
            if (this.pokerSentIndex >= this.pokerHandCount && this.pokerSentIndex < this.pokerCount) {
                Laya.timer.loop(300, this, this.onShowPublicPoker);
            }
            if (this.chip2Index >= this.seats.length) {
                this.chip2Index = 0;
            }
            // 小盲移动到大盲位置
            this.chip1.x = this.chip2.x;
            this.chip1.y = this.chip2.y;
            this.chipText1.x = this.chipText2.x;
            this.chipText1.y = this.chipText2.y;
            // 大盲顺时针移动
            this.chip2.x = this.seats[this.chip2Index].x + 10;
            this.chip2.y = this.seats[this.chip2Index].y - 30;
            this.chipText2.x = this.chip2.x - 10;
            this.chipText2.y = this.chip2.y - 15;
            this.chip2Index++;
        }

        // 展开三张公牌

    }, {
        key: 'onShowPublicPoker',
        value: function onShowPublicPoker() {
            this.pokers[this.pokerSentIndex].sendPublic(this.pokerSentIndex - this.pokerHandCount);
            this.pokerSentIndex++;
            // 发牌行为结束
            if (this.pokerSentIndex >= this.pokerHandCount + 3) {
                Laya.timer.clear(this, this.onShowPublicPoker);
            }
        }
    }]);

    return GameView;
}(Laya.Scene);

exports.default = GameView;

},{"../sprite/Poker":3,"../util/WebSocket":6}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL0FwcGxpY2F0aW9ucy9MYXlhQWlySURFX2JldGEuYXBwL0NvbnRlbnRzL1Jlc291cmNlcy9hcHAvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsInNyYy9HYW1lQ29uZmlnLmpzIiwic3JjL01haW4uanMiLCJzcmMvc3ByaXRlL1Bva2VyLmpzIiwic3JjL3Nwcml0ZS9TZWF0LmpzIiwic3JjL3Nwcml0ZS9TdGFydC5qcyIsInNyYy91dGlsL1dlYlNvY2tldC5qcyIsInNyYy92aWV3L0dhbWVWaWV3LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7cWpCQ1ZBOzs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7Ozs7O0lBRXFCLFU7Ozs7Ozs7K0JBQ0g7QUFDVjtBQUNBLGdCQUFJLE1BQU0sS0FBSyxVQUFMLENBQWdCLFFBQTFCO0FBQ04sZ0JBQUksa0JBQUosRUFBdUIsa0JBQXZCO0FBQ0EsZ0JBQUksZ0JBQUosRUFBcUIsY0FBckI7QUFDQSxnQkFBSSxpQkFBSixFQUFzQixlQUF0QjtBQUNHOzs7Ozs7a0JBUGdCLFU7O0FBU3JCLFdBQVcsS0FBWCxHQUFtQixHQUFuQjtBQUNBLFdBQVcsTUFBWCxHQUFvQixHQUFwQjtBQUNBLFdBQVcsU0FBWCxHQUFzQixTQUF0QjtBQUNBLFdBQVcsVUFBWCxHQUF3QixNQUF4QjtBQUNBLFdBQVcsTUFBWCxHQUFvQixRQUFwQjtBQUNBLFdBQVcsTUFBWCxHQUFvQixRQUFwQjtBQUNBLFdBQVcsVUFBWCxHQUF3QixhQUF4QjtBQUNBLFdBQVcsU0FBWCxHQUF1QixFQUF2QjtBQUNBLFdBQVcsS0FBWCxHQUFtQixLQUFuQjtBQUNBLFdBQVcsSUFBWCxHQUFrQixLQUFsQjtBQUNBLFdBQVcsWUFBWCxHQUEwQixLQUExQjtBQUNBLFdBQVcsaUJBQVgsR0FBK0IsSUFBL0I7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QUFLLEtBQUwsQ0FBVyxDQUFYLEdBQWUsS0FBSyxLQUFMLENBQVcsS0FBSyxVQUFoQixFQUE0QixDQUE1QixHQUFnQyxFQUEvQztBQUNBLGlCQUFLLFNBQUwsQ0FBZSxDQUFmLEdBQW1CLEtBQUssS0FBTCxDQUFXLENBQVgsR0FBZSxFQUFsQztBQUNBLGlCQUFLLFNBQUwsQ0FBZSxDQUFmLEdBQW1CLEtBQUssS0FBTCxDQUFXLENBQVgsR0FBZSxFQUFsQztBQUNBLGlCQUFLLFVBQUw7QUFDSDs7QUFFRDs7Ozs0Q0FDb0I7QUFDaEIsaUJBQUssTUFBTCxDQUFZLEtBQUssY0FBakIsRUFBaUMsVUFBakMsQ0FBNEMsS0FBSyxjQUFMLEdBQXNCLEtBQUssY0FBdkU7QUFDQSxpQkFBSyxjQUFMO0FBQ0E7QUFDQSxnQkFBSSxLQUFLLGNBQUwsSUFBdUIsS0FBSyxjQUFMLEdBQXNCLENBQWpELEVBQW9EO0FBQ2hELHFCQUFLLEtBQUwsQ0FBVyxLQUFYLENBQWlCLElBQWpCLEVBQXVCLEtBQUssaUJBQTVCO0FBQ0g7QUFDSjs7OztFQWhHaUMsS0FBSyxLOztrQkFBdEIsUSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuICAgIH07XHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCIvKipUaGlzIGNsYXNzIGlzIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGVkIGJ5IExheWFBaXJJREUsIHBsZWFzZSBkbyBub3QgbWFrZSBhbnkgbW9kaWZpY2F0aW9ucy4gKi9cclxuaW1wb3J0IEdhbWVWaWV3IGZyb20gXCIuL3ZpZXcvR2FtZVZpZXdcIlxuaW1wb3J0IFNlYXQgZnJvbSBcIi4vc3ByaXRlL1NlYXRcIlxuaW1wb3J0IFN0YXJ0IGZyb20gXCIuL3Nwcml0ZS9TdGFydFwiXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lQ29uZmlnIHtcclxuICAgIHN0YXRpYyBpbml0KCkge1xyXG4gICAgICAgIC8v5rOo5YaMU2NyaXB05oiW6ICFUnVudGltZeW8leeUqFxyXG4gICAgICAgIGxldCByZWcgPSBMYXlhLkNsYXNzVXRpbHMucmVnQ2xhc3M7XHJcblx0XHRyZWcoXCJ2aWV3L0dhbWVWaWV3LmpzXCIsR2FtZVZpZXcpO1xuXHRcdHJlZyhcInNwcml0ZS9TZWF0LmpzXCIsU2VhdCk7XG5cdFx0cmVnKFwic3ByaXRlL1N0YXJ0LmpzXCIsU3RhcnQpO1xyXG4gICAgfVxyXG59XHJcbkdhbWVDb25maWcud2lkdGggPSAzNzA7XHJcbkdhbWVDb25maWcuaGVpZ2h0ID0gNjU4O1xyXG5HYW1lQ29uZmlnLnNjYWxlTW9kZSA9XCJzaG93YWxsXCI7XHJcbkdhbWVDb25maWcuc2NyZWVuTW9kZSA9IFwibm9uZVwiO1xyXG5HYW1lQ29uZmlnLmFsaWduViA9IFwibWlkZGxlXCI7XHJcbkdhbWVDb25maWcuYWxpZ25IID0gXCJjZW50ZXJcIjtcclxuR2FtZUNvbmZpZy5zdGFydFNjZW5lID0gXCJTdGFydC5zY2VuZVwiO1xyXG5HYW1lQ29uZmlnLnNjZW5lUm9vdCA9IFwiXCI7XHJcbkdhbWVDb25maWcuZGVidWcgPSBmYWxzZTtcclxuR2FtZUNvbmZpZy5zdGF0ID0gZmFsc2U7XHJcbkdhbWVDb25maWcucGh5c2ljc0RlYnVnID0gZmFsc2U7XHJcbkdhbWVDb25maWcuZXhwb3J0U2NlbmVUb0pzb24gPSB0cnVlO1xyXG5cclxuR2FtZUNvbmZpZy5pbml0KCk7XHJcbiIsImltcG9ydCBHYW1lQ29uZmlnIGZyb20gJy4vR2FtZUNvbmZpZydcclxuaW1wb3J0IFdlYlNvY2tldCBmcm9tICcuL3V0aWwvV2ViU29ja2V0J1xyXG5cclxuY2xhc3MgTWFpbiB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICAvL+agueaNrklEReiuvue9ruWIneWni+WMluW8leaTjlxyXG4gICAgICAgIGlmICh3aW5kb3dbXCJMYXlhM0RcIl0pIExheWEzRC5pbml0KEdhbWVDb25maWcud2lkdGgsIEdhbWVDb25maWcuaGVpZ2h0KTtcclxuICAgICAgICBlbHNlIExheWEuaW5pdChHYW1lQ29uZmlnLndpZHRoLCBHYW1lQ29uZmlnLmhlaWdodCwgTGF5YVtcIldlYkdMXCJdKTtcclxuICAgICAgICBMYXlhW1wiUGh5c2ljc1wiXSAmJiBMYXlhW1wiUGh5c2ljc1wiXS5lbmFibGUoKTtcclxuICAgICAgICBMYXlhW1wiRGVidWdQYW5lbFwiXSAmJiBMYXlhW1wiRGVidWdQYW5lbFwiXS5lbmFibGUoKTtcclxuICAgICAgICBMYXlhLnN0YWdlLnNjYWxlTW9kZSA9IEdhbWVDb25maWcuc2NhbGVNb2RlO1xyXG4gICAgICAgIExheWEuc3RhZ2Uuc2NyZWVuTW9kZSA9IEdhbWVDb25maWcuc2NyZWVuTW9kZTtcclxuICAgICAgICBMYXlhLnN0YWdlLmFsaWduViA9IEdhbWVDb25maWcuYWxpZ25WO1xyXG4gICAgICAgIExheWEuc3RhZ2UuYWxpZ25IID0gR2FtZUNvbmZpZy5hbGlnbkg7XHJcbiAgICAgICAgLy/lhbzlrrnlvq7kv6HkuI3mlK/mjIHliqDovb1zY2VuZeWQjue8gOWcuuaZr1xyXG4gICAgICAgIExheWEuVVJMLmV4cG9ydFNjZW5lVG9Kc29uID0gR2FtZUNvbmZpZy5leHBvcnRTY2VuZVRvSnNvblxyXG5cclxuICAgICAgICAvL+aJk+W8gOiwg+ivlemdouadv++8iOmAmui/h0lEReiuvue9ruiwg+ivleaooeW8j++8jOaIluiAhXVybOWcsOWdgOWinuWKoGRlYnVnPXRydWXlj4LmlbDvvIzlnYflj6/miZPlvIDosIPor5XpnaLmnb/vvIlcclxuICAgICAgICBpZiAoR2FtZUNvbmZpZy5kZWJ1ZyB8fCBMYXlhLlV0aWxzLmdldFF1ZXJ5U3RyaW5nKFwiZGVidWdcIikgPT0gXCJ0cnVlXCIpIExheWEuZW5hYmxlRGVidWdQYW5lbCgpO1xyXG4gICAgICAgIGlmIChHYW1lQ29uZmlnLnBoeXNpY3NEZWJ1ZyAmJiBMYXlhW1wiUGh5c2ljc0RlYnVnRHJhd1wiXSkgTGF5YVtcIlBoeXNpY3NEZWJ1Z0RyYXdcIl0uZW5hYmxlKCk7XHJcbiAgICAgICAgaWYgKEdhbWVDb25maWcuc3RhdCkgTGF5YS5TdGF0LnNob3coKTtcclxuICAgICAgICBMYXlhLmFsZXJ0R2xvYmFsRXJyb3IgPSB0cnVlO1xyXG5cclxuICAgICAgICAvL+a/gOa0u+i1hOa6kOeJiOacrOaOp+WItu+8jHZlcnNpb24uanNvbueUsUlEReWPkeW4g+WKn+iDveiHquWKqOeUn+aIkO+8jOWmguaenOayoeacieS5n+S4jeW9seWTjeWQjue7rea1geeoi1xyXG4gICAgICAgIExheWEuUmVzb3VyY2VWZXJzaW9uLmVuYWJsZShcInZlcnNpb24uanNvblwiLCBMYXlhLkhhbmRsZXIuY3JlYXRlKHRoaXMsIHRoaXMub25WZXJzaW9uTG9hZGVkKSwgTGF5YS5SZXNvdXJjZVZlcnNpb24uRklMRU5BTUVfVkVSU0lPTilcclxuICAgICAgICAvL+WKoOi9vee9kee7nOi/nuaOpVxyXG4gICAgICAgIG5ldyBXZWJTb2NrZXQoKS5pbml0KClcclxuICAgIH1cclxuICAgIG9uVmVyc2lvbkxvYWRlZCgpIHtcclxuICAgICAgICAvL+a/gOa0u+Wkp+Wwj+WbvuaYoOWwhO+8jOWKoOi9veWwj+WbvueahOaXtuWAme+8jOWmguaenOWPkeeOsOWwj+WbvuWcqOWkp+WbvuWQiOmbhumHjOmdou+8jOWImeS8mOWFiOWKoOi9veWkp+WbvuWQiOmbhu+8jOiAjOS4jeaYr+Wwj+WbvlxyXG4gICAgICAgIExheWEuQXRsYXNJbmZvTWFuYWdlci5lbmFibGUoXCJmaWxlY29uZmlnLmpzb25cIiwgTGF5YS5IYW5kbGVyLmNyZWF0ZSh0aGlzLCB0aGlzLm9uQ29uZmlnTG9hZGVkKSlcclxuICAgIH1cclxuICAgIG9uQ29uZmlnTG9hZGVkKCkge1xyXG4gICAgICAgIC8v5Yqg6L29SURF5oyH5a6a55qE5Zy65pmvXHJcbiAgICAgICAgR2FtZUNvbmZpZy5zdGFydFNjZW5lICYmIExheWEuU2NlbmUub3BlbihHYW1lQ29uZmlnLnN0YXJ0U2NlbmUpXHJcbiAgICAgICAgLy8gYmVnaW5Mb2FkKClcclxuICAgIH1cclxuICAgIC8vIC8vIOWKoOi9vei1hOa6kFxyXG4gICAgLy8gYmVnaW5Mb2FkKCkge1xyXG4gICAgLy8gICAgIC8vIOWKoOi9veWbvumbhlxyXG4gICAgLy8gICAgIExheWEubG9hZGVyLmxvYWQoXCJyZXMvYXRsYXMvdWkuYXRsYXNcIiwgTGF5YS5IYW5kbGVyLmNyZWF0ZSh0aGlzLCB0aGlzLm9uTG9hZGVkKSwgbnVsbCwgTGF5YS5Mb2FkZXIuQVRMQVMpXHJcbiAgICAvLyAgICAgLy8g5pKt5pS+6IOM5pmv6Z+z5LmQXHJcbiAgICAvLyAgICAgLy8gTGF5YS5Tb3VuZE1hbmFnZXIucGxheU11c2ljKFwicmVzL3NvdW5kcy9iZ20ubXAzXCIsIDAsIG51bGwpXHJcbiAgICAvLyB9XHJcbiAgICAvLyAvLyDliqDovb3lrozmiJDlm57osINcclxuICAgIC8vIG9uTG9hZGVkKCkge1xyXG4gICAgLy8gICAgIC8vIOWQr+WKqOa4uOaIj+eVjOmdolxyXG4gICAgLy8gICAgIExheWFBcHAuZ2FtZVZpZXcgPSBuZXcgR2FtZVZpZXcoKVxyXG4gICAgLy8gICAgIExheWEuc3RhZ2UuYWRkQ2hpbGQoTGF5YUFwcC5nYW1lVmlldylcclxuICAgIC8vICAgICAvLyBMYXlhQXBwLmdhbWVTdGFydFZpZXcgPSBuZXcgR2FtZVN0YXJ0VmlldygpXHJcbiAgICAvLyAgICAgLy8gTGF5YS5zdGFnZS5hZGRDaGlsZChMYXlhQXBwLmdhbWVTdGFydFZpZXcpXHJcbiAgICAvLyB9XHJcbn1cclxuXHJcbi8v5r+A5rS75ZCv5Yqo57G7XHJcbm5ldyBNYWluKClcclxuXHJcbiIsIi8qKlxuICog5omR5YWL57G7XG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBva2VyIHtcbiAgICBjb25zdHJ1Y3RvcihpbnBhcmFtKSB7XG4gICAgICAgIHRoaXMucG9rZXJJbWcgPSBpbnBhcmFtLnBva2VySW1nXG4gICAgICAgIHRoaXMuc2VhdEltZyA9IGlucGFyYW0uc2VhdEltZ1xuICAgICAgICB0aGlzLmRhdGFQb2tlciA9IGlucGFyYW0uZGF0YVBva2VyXG4gICAgICAgIHRoaXMuaXNNZSA9IGZhbHNlXG4gICAgICAgIC8vIHRoaXMucmVzZXQoKVxuICAgIH1cbiAgICAvLyDph43nva5cbiAgICByZXNldCgpIHtcbiAgICB9XG4gICAgLy8g6ZqQ6JePXG4gICAgaGlkZSgpIHtcbiAgICAgICAgdGhpcy5wb2tlckltZy52aXNpYmxlID0gZmFsc2VcbiAgICB9XG4gICAgLy8g5Y+R54mMXG4gICAgc2VuZChwb2tlclNlbnRJbmRleCkge1xuICAgICAgICB0aGlzLmlzTWUgPSB0aGlzLnNlYXRJbWcubmFtZSA9PSAnc2VhdDAnID8gdHJ1ZSA6IGZhbHNlXG4gICAgICAgIGxldCB4ID0gdGhpcy5zZWF0SW1nLnhcbiAgICAgICAgaWYgKHRoaXMuaXNNZSkge1xuICAgICAgICAgICAgcG9rZXJTZW50SW5kZXggPT0gMCA/IHggKz0gNTAgOiB4ICs9IDEwMFxuICAgICAgICB9XG4gICAgICAgIExheWEuVHdlZW4udG8odGhpcy5wb2tlckltZywgeyB4LCB5OiB0aGlzLnNlYXRJbWcueSB9LCA1MDAsIExheWEuRWFzZS5zdHJvbmdPdXQsIExheWEuSGFuZGxlci5jcmVhdGUodGhpcywgdGhpcy5zZW5kQ29tcGxldGUpKVxuICAgIH1cbiAgICAvLyDmiYvniYzlj5HniYzlrozmiJBcbiAgICBzZW5kQ29tcGxldGUoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc01lKSB7XG4gICAgICAgICAgICB0aGlzLnBva2VySW1nLnZpc2libGUgPSBmYWxzZVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5wb2tlckltZy5za2luID0gYHVpLyR7dGhpcy5kYXRhUG9rZXIuY2FyZH0ucG5nYFxuICAgICAgICB9XG4gICAgfVxuICAgIC8vIOWPkeWFrOWFseeJjFxuICAgIHNlbmRQdWJsaWMocHVibGljSW5kZXgpIHtcbiAgICAgICAgbGV0IHggPSB0aGlzLnBva2VySW1nLnhcbiAgICAgICAgbGV0IHkgPSB0aGlzLnBva2VySW1nLnkgKyA4MFxuICAgICAgICBzd2l0Y2ggKHB1YmxpY0luZGV4KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgeCAtPSAxMTBcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICB4IC09IDU1XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgeCArPSA1NVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgIHggKz0gMTEwXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIExheWEuVHdlZW4udG8odGhpcy5wb2tlckltZywgeyB4LCB5IH0sIDUwMCwgTGF5YS5FYXNlLnN0cm9uZ091dCwgTGF5YS5IYW5kbGVyLmNyZWF0ZSh0aGlzLCB0aGlzLnNlbmRQdWJsaWNDb21wbGV0ZSkpXG4gICAgfVxuICAgIC8vIOWFrOeJjOWPkeeJjOWujOaIkFxuICAgIHNlbmRQdWJsaWNDb21wbGV0ZSgpIHtcbiAgICAgICAgdGhpcy5wb2tlckltZy5za2luID0gYHVpLyR7dGhpcy5kYXRhUG9rZXIuY2FyZH0ucG5nYFxuICAgIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTdGFydCBleHRlbmRzIExheWEuU2NyaXB0e1xuICAgIG9uRW5hYmxlKCl7XG4gICAgfVxuICAgIG9uQ2xpY2soKXtcbiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcylcbiAgICAgICAgY29uc29sZS5sb2codGhpcy5vd25lci5uYW1lKVxuICAgICAgICB0aGlzLm93bmVyLnNraW4gPSAndWkvcGVyc29uLnBuZydcbiAgICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3RhcnQgZXh0ZW5kcyBMYXlhLlNjcmlwdHtcbiAgICBvbkVuYWJsZSgpe1xuXG4gICAgfVxuICAgIG9uQ2xpY2soKXtcbiAgICAgICAgTGF5YS5TY2VuZS5vcGVuKCdHYW1lLnNjZW5lJylcbiAgICB9XG59IiwiLyoqXG4gKiDnvZHnu5zplb/ov57mjqXnsbtcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgV2ViU29ja2V0IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgV2ViU29ja2V0Lmluc3RhbmNlID0gdGhpc1xuICAgICAgICAvLyDplb/ov57mjqXmnI3liqHlmahcbiAgICAgICAgV2ViU29ja2V0LnNvY2tldCA9IG5ldyBMYXlhLlNvY2tldCgpXG4gICAgICAgIFdlYlNvY2tldC5zb2NrZXQuZW5kaWFuID0gTGF5YS5CeXRlLkxJVFRMRV9FTkRJQU4vL+mHh+eUqOWwj+err1xuICAgIH1cbiAgICBpbml0KCkge1xuICAgICAgICBXZWJTb2NrZXQuc29ja2V0LmNvbm5lY3RCeVVybCgnd3M6Ly9sb2NhbGhvc3Q6NTAwMC9zb2NrZXQvcG9rZXInKVxuICAgICAgICBXZWJTb2NrZXQuc29ja2V0Lm9uKExheWEuRXZlbnQuT1BFTiwgdGhpcywgKGUpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfov57mjqXlu7rnq4snKVxuICAgICAgICB9KVxuICAgICAgICBXZWJTb2NrZXQuc29ja2V0Lm9uKExheWEuRXZlbnQuQ0xPU0UsIHRoaXMsIChlKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygn6L+e5o6l5YWz6ZetJylcbiAgICAgICAgfSlcbiAgICAgICAgV2ViU29ja2V0LnNvY2tldC5vbihMYXlhLkV2ZW50LkVSUk9SLCB0aGlzLCAoZSkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign6L+e5o6l5Ye66ZSZJylcbiAgICAgICAgfSlcbiAgICAgICAgLy8g5bCB6KOF5Y+R6YCB5pWw5o2u5pa55rOVXG4gICAgICAgIFdlYlNvY2tldC5zZW5kID0gKHJlcSkgPT4ge1xuICAgICAgICAgICAgLy8gdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgV2ViU29ja2V0LnNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHJlcSkpXG4gICAgICAgICAgICAgICAgLy8g6L+U5Zue5pWw5o2uXG4gICAgICAgICAgICAgICAgV2ViU29ja2V0LnNvY2tldC5vbihMYXlhLkV2ZW50Lk1FU1NBR0UsIHRoaXMsIChyZXMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmVzID0gSlNPTi5wYXJzZShyZXMpXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXEubWV0aG9kID09IHJlcy5tZXRob2QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAvLyB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgLy8gICAgICAgICBjb25zb2xlLmxvZyhg6YeN6K+V5Y+R6YCB77yaJHtkYXRhfWApXG4gICAgICAgICAgICAvLyAgICAgICAgIFdlYlNvY2tldC5zZW5kKGRhdGEpXG4gICAgICAgICAgICAvLyAgICAgfSwgNTAwKVxuICAgICAgICAgICAgLy8gfVxuICAgICAgICB9XG4gICAgfVxufSIsImltcG9ydCBXZWJTb2NrZXQgZnJvbSAnLi4vdXRpbC9XZWJTb2NrZXQnXG5pbXBvcnQgUG9rZXIgZnJvbSAnLi4vc3ByaXRlL1Bva2VyJ1xuXG4vKipcbiAqIOa4uOaIj+S4u+eVjOmdouexu1xuICog6L295YWl5omR5YWL5qGMXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdhbWVWaWV3IGV4dGVuZHMgTGF5YS5TY2VuZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKClcbiAgICAgICAgLy/orr7nva7ljZXkvovnmoTlvJXnlKjmlrnlvI/vvIzmlrnkvr/lhbbku5bnsbvlvJXnlKhcbiAgICAgICAgR2FtZVZpZXcuaW5zdGFuY2UgPSB0aGlzXG4gICAgICAgIHRoaXMuc2VhdENvdW50ID0gOSAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5bqn5L2N5pWw6YePICAgIFxuICAgICAgICB0aGlzLnNlYXRzID0gW10gICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOW6p+S9jeaVsOe7hCAgICAgICAgICAgXG4gICAgICAgIHRoaXMucG9rZXJzID0gW10gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5omR5YWL54mM5pWw57uEXG4gICAgICAgIHRoaXMucG9rZXJTZW50SW5kZXggPSAwICAgICAgICAgICAgICAgICAgICAgLy8g5bey5Y+R54mM57Si5byVXG4gICAgICAgIHRoaXMucG9rZXJIYW5kQ291bnQgPSB0aGlzLnNlYXRDb3VudCAqIDIgICAgLy8g5omL54mM5pWw6YePXG4gICAgICAgIHRoaXMucG9rZXJDb3VudCA9IHRoaXMucG9rZXJIYW5kQ291bnQgKyA1ICAgLy8g5omA5pyJ54mM5pWw6YePXG4gICAgICAgIHRoaXMuY2hpcDJJbmRleCA9IDAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5aSn55uy5L2N57Si5byVXG4gICAgfVxuICAgIG9uRW5hYmxlKCkge1xuICAgICAgICAvLyDliJ3lp4vljJZcbiAgICAgICAgdGhpcy5pbml0KClcbiAgICB9XG4gICAgb25DbG9zZWQoKSB7XG4gICAgICAgIFdlYlNvY2tldC5zb2NrZXQuY2xvc2UoKVxuICAgIH1cbiAgICAvLyDliJ3lp4vljJZcbiAgICBpbml0KCkge1xuICAgICAgICAvLyDliJ3lp4vljJbmoYzkvY1cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnNlYXRDb3VudDsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLnNlYXRzLnB1c2godGhpcy5nZXRDaGlsZEJ5TmFtZShgc2VhdCR7aX1gKSlcbiAgICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIC8vIOWIneWni+WMlueJjOe7hFxuICAgICAgICBXZWJTb2NrZXQuc2VuZCh7IG1ldGhvZDogJ1NFTkRfQ0FSRCcsIGNvdW50OiB0aGlzLnBva2VyQ291bnQgfSkudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLnBva2Vycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGxldCBwb2tlciA9IHt9XG4gICAgICAgICAgICAgICAgLy8g5omL54mMXG4gICAgICAgICAgICAgICAgaWYgKGkgPCB0aGlzLnBva2VySGFuZENvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHBva2VyID0gbmV3IFBva2VyKHsgcG9rZXJJbWc6IHRoaXMuZ2V0Q2hpbGRCeU5hbWUoYHBva2VyJHtpfWApLCBzZWF0SW1nOiB0aGlzLnNlYXRzW2kgJSB0aGlzLnNlYXRDb3VudF0sIGRhdGFQb2tlcjogZGF0YS5wb2tlcnNbaV0gfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8g5YWs54mMXG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHBva2VyID0gbmV3IFBva2VyKHsgcG9rZXJJbWc6IHRoaXMuZ2V0Q2hpbGRCeU5hbWUoYHBva2VyJHtpfWApLCBkYXRhUG9rZXI6IGRhdGEucG9rZXJzW2ldIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucG9rZXJzLnB1c2gocG9rZXIpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyDlkK/liqjmuLjmiI9cbiAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXJ0KClcbiAgICAgICAgfSlcbiAgICAgICAgLy8g5Yqg6L296byg5qCH54K55Ye75LqL5Lu2XG4gICAgICAgIExheWEuc3RhZ2Uub24oTGF5YS5FdmVudC5NT1VTRV9ET1dOLCB0aGlzLCB0aGlzLm9uTW91c2VEb3duKVxuICAgIH1cbiAgICAvLyDmuLjmiI/lkK/liqhcbiAgICBnYW1lU3RhcnQoKSB7XG4gICAgICAgIC8vIOavj+S6uuWPkeS4pOW8oOeJjFxuICAgICAgICBMYXlhLnRpbWVyLmxvb3AoMzAwLCB0aGlzLCB0aGlzLm9uU2VuZFBva2VyKSAgLy8g5q+PMzAw5q+r5b6q546v5LiA5qyhXG4gICAgICAgIC8vIExheWEudGltZXIuZnJhbWVMb29wKDEwLCB0aGlzLCB0aGlzLm9uTG9vcCkgLy8g5q+PMTDluKflvqrnjq/kuIDmrKFcbiAgICB9XG4gICAgLy8g5Y+R54mMXG4gICAgb25TZW5kUG9rZXIoKSB7XG4gICAgICAgIHRoaXMucG9rZXJzW3RoaXMucG9rZXJTZW50SW5kZXhdLnNlbmQodGhpcy5wb2tlclNlbnRJbmRleClcbiAgICAgICAgdGhpcy5wb2tlclNlbnRJbmRleCsrXG4gICAgICAgIC8vIOaJi+eJjOWPkeeJjOe7k+adn1xuICAgICAgICBpZiAodGhpcy5wb2tlclNlbnRJbmRleCA9PSB0aGlzLnBva2VySGFuZENvdW50KSB7XG4gICAgICAgICAgICAvLyDpmpDol4/liankvZnniYzvvIzkuLrlsZXlvIDlhazniYzlgZrlh4blpIdcbiAgICAgICAgICAgIC8vIGZvciAobGV0IGkgPSB0aGlzLnBva2VyU2VudEluZGV4ICsgMTsgaSA8PSAyMjsgaSsrKSB7XG4gICAgICAgICAgICAvLyAgICAgdGhpcy5wb2tlcnNbaV0uaGlkZSgpXG4gICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICBMYXlhLnRpbWVyLmNsZWFyKHRoaXMsIHRoaXMub25TZW5kUG9rZXIpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyDpvKDmoIfngrnlh7vkuovku7ZcbiAgICBvbk1vdXNlRG93bigpIHtcbiAgICAgICAgaWYgKHRoaXMucG9rZXJTZW50SW5kZXggPj0gdGhpcy5wb2tlckhhbmRDb3VudCAmJiB0aGlzLnBva2VyU2VudEluZGV4IDwgdGhpcy5wb2tlckNvdW50KSB7XG4gICAgICAgICAgICBMYXlhLnRpbWVyLmxvb3AoMzAwLCB0aGlzLCB0aGlzLm9uU2hvd1B1YmxpY1Bva2VyKVxuICAgICAgICB9XG4gICAgICAgIGlmKHRoaXMuY2hpcDJJbmRleCA+PSB0aGlzLnNlYXRzLmxlbmd0aCl7XG4gICAgICAgICAgICB0aGlzLmNoaXAySW5kZXggPSAwXG4gICAgICAgIH1cbiAgICAgICAgLy8g5bCP55uy56e75Yqo5Yiw5aSn55uy5L2N572uXG4gICAgICAgIHRoaXMuY2hpcDEueCA9IHRoaXMuY2hpcDIueFxuICAgICAgICB0aGlzLmNoaXAxLnkgPSB0aGlzLmNoaXAyLnlcbiAgICAgICAgdGhpcy5jaGlwVGV4dDEueCA9IHRoaXMuY2hpcFRleHQyLnhcbiAgICAgICAgdGhpcy5jaGlwVGV4dDEueSA9IHRoaXMuY2hpcFRleHQyLnlcbiAgICAgICAgLy8g5aSn55uy6aG65pe26ZKI56e75YqoXG4gICAgICAgIHRoaXMuY2hpcDIueCA9IHRoaXMuc2VhdHNbdGhpcy5jaGlwMkluZGV4XS54ICsgMTBcbiAgICAgICAgdGhpcy5jaGlwMi55ID0gdGhpcy5zZWF0c1t0aGlzLmNoaXAySW5kZXhdLnkgLSAzMFxuICAgICAgICB0aGlzLmNoaXBUZXh0Mi54ID0gdGhpcy5jaGlwMi54IC0gMTBcbiAgICAgICAgdGhpcy5jaGlwVGV4dDIueSA9IHRoaXMuY2hpcDIueSAtIDE1XG4gICAgICAgIHRoaXMuY2hpcDJJbmRleCsrXG4gICAgfVxuXG4gICAgLy8g5bGV5byA5LiJ5byg5YWs54mMXG4gICAgb25TaG93UHVibGljUG9rZXIoKSB7XG4gICAgICAgIHRoaXMucG9rZXJzW3RoaXMucG9rZXJTZW50SW5kZXhdLnNlbmRQdWJsaWModGhpcy5wb2tlclNlbnRJbmRleCAtIHRoaXMucG9rZXJIYW5kQ291bnQpXG4gICAgICAgIHRoaXMucG9rZXJTZW50SW5kZXgrK1xuICAgICAgICAvLyDlj5HniYzooYzkuLrnu5PmnZ9cbiAgICAgICAgaWYgKHRoaXMucG9rZXJTZW50SW5kZXggPj0gdGhpcy5wb2tlckhhbmRDb3VudCArIDMpIHtcbiAgICAgICAgICAgIExheWEudGltZXIuY2xlYXIodGhpcywgdGhpcy5vblNob3dQdWJsaWNQb2tlcilcbiAgICAgICAgfVxuICAgIH1cbn0iXX0=
