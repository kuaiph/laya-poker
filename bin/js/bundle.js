var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**This class is automatically generated by LayaAirIDE, please do not make any modifications. */


var _GameView = require("./view/GameView");

var _GameView2 = _interopRequireDefault(_GameView);

var _Seat = require("./sprite/Seat");

var _Seat2 = _interopRequireDefault(_Seat);

var _Start = require("./sprite/Start");

var _Start2 = _interopRequireDefault(_Start);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var GameConfig = function () {
    function GameConfig() {
        _classCallCheck(this, GameConfig);
    }

    _createClass(GameConfig, null, [{
        key: "init",
        value: function init() {
            //注册Script或者Runtime引用
            var reg = Laya.ClassUtils.regClass;
            reg("view/GameView.js", _GameView2.default);
            reg("sprite/Seat.js", _Seat2.default);
            reg("sprite/Start.js", _Start2.default);
        }
    }]);

    return GameConfig;
}();

exports.default = GameConfig;

GameConfig.width = 370;
GameConfig.height = 658;
GameConfig.scaleMode = "showall";
GameConfig.screenMode = "none";
GameConfig.alignV = "middle";
GameConfig.alignH = "center";
GameConfig.startScene = "Start.scene";
GameConfig.sceneRoot = "";
GameConfig.debug = false;
GameConfig.stat = false;
GameConfig.physicsDebug = false;
GameConfig.exportSceneToJson = true;

GameConfig.init();

},{"./sprite/Seat":4,"./sprite/Start":5,"./view/GameView":7}],2:[function(require,module,exports){
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _GameConfig = require('./GameConfig');

var _GameConfig2 = _interopRequireDefault(_GameConfig);

var _WebSocket = require('./util/WebSocket');

var _WebSocket2 = _interopRequireDefault(_WebSocket);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Main = function () {
    function Main() {
        _classCallCheck(this, Main);

        //根据IDE设置初始化引擎
        if (window["Laya3D"]) Laya3D.init(_GameConfig2.default.width, _GameConfig2.default.height);else Laya.init(_GameConfig2.default.width, _GameConfig2.default.height, Laya["WebGL"]);
        Laya["Physics"] && Laya["Physics"].enable();
        Laya["DebugPanel"] && Laya["DebugPanel"].enable();
        Laya.stage.scaleMode = _GameConfig2.default.scaleMode;
        Laya.stage.screenMode = _GameConfig2.default.screenMode;
        Laya.stage.alignV = _GameConfig2.default.alignV;
        Laya.stage.alignH = _GameConfig2.default.alignH;
        //兼容微信不支持加载scene后缀场景
        Laya.URL.exportSceneToJson = _GameConfig2.default.exportSceneToJson;

        //打开调试面板（通过IDE设置调试模式，或者url地址增加debug=true参数，均可打开调试面板）
        if (_GameConfig2.default.debug || Laya.Utils.getQueryString("debug") == "true") Laya.enableDebugPanel();
        if (_GameConfig2.default.physicsDebug && Laya["PhysicsDebugDraw"]) Laya["PhysicsDebugDraw"].enable();
        if (_GameConfig2.default.stat) Laya.Stat.show();
        Laya.alertGlobalError = true;

        //激活资源版本控制，version.json由IDE发布功能自动生成，如果没有也不影响后续流程
        Laya.ResourceVersion.enable("version.json", Laya.Handler.create(this, this.onVersionLoaded), Laya.ResourceVersion.FILENAME_VERSION);
        //加载网络连接
        new _WebSocket2.default().init();
    }

    _createClass(Main, [{
        key: 'onVersionLoaded',
        value: function onVersionLoaded() {
            //激活大小图映射，加载小图的时候，如果发现小图在大图合集里面，则优先加载大图合集，而不是小图
            Laya.AtlasInfoManager.enable("fileconfig.json", Laya.Handler.create(this, this.onConfigLoaded));
        }
    }, {
        key: 'onConfigLoaded',
        value: function onConfigLoaded() {
            //加载IDE指定的场景
            _GameConfig2.default.startScene && Laya.Scene.open(_GameConfig2.default.startScene);
            // beginLoad()
        }
        // // 加载资源
        // beginLoad() {
        //     // 加载图集
        //     Laya.loader.load("res/atlas/ui.atlas", Laya.Handler.create(this, this.onLoaded), null, Laya.Loader.ATLAS)
        //     // 播放背景音乐
        //     // Laya.SoundManager.playMusic("res/sounds/bgm.mp3", 0, null)
        // }
        // // 加载完成回调
        // onLoaded() {
        //     // 启动游戏界面
        //     LayaApp.gameView = new GameView()
        //     Laya.stage.addChild(LayaApp.gameView)
        //     // LayaApp.gameStartView = new GameStartView()
        //     // Laya.stage.addChild(LayaApp.gameStartView)
        // }

    }]);

    return Main;
}();

//激活启动类


new Main();

},{"./GameConfig":1,"./util/WebSocket":6}],3:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/**
 * 扑克类
 */
var Poker = function () {
    function Poker(inparam) {
        _classCallCheck(this, Poker);

        this.pokerImg = inparam.pokerImg;
        this.seatImg = inparam.seatImg;
        this.dataPoker = inparam.dataPoker;
        this.isMe = false;
        // this.reset()
    }
    // 重置


    _createClass(Poker, [{
        key: 'reset',
        value: function reset() {}
        // 隐藏

    }, {
        key: 'hide',
        value: function hide() {
            this.pokerImg.visible = false;
        }
        // 发牌

    }, {
        key: 'send',
        value: function send(pokerSentIndex) {
            this.isMe = this.seatImg.name == 'seat0' ? true : false;
            var x = this.seatImg.x;
            if (this.isMe) {
                pokerSentIndex == 0 ? x += 50 : x += 100;
            }
            Laya.Tween.to(this.pokerImg, { x: x, y: this.seatImg.y }, 500, Laya.Ease.strongOut, Laya.Handler.create(this, this.sendComplete));
        }
        // 手牌发牌完成

    }, {
        key: 'sendComplete',
        value: function sendComplete() {
            if (!this.isMe) {
                this.pokerImg.visible = false;
            } else {
                this.pokerImg.skin = 'ui/' + this.dataPoker.card + '.png';
            }
        }
        // 发公共牌

    }, {
        key: 'sendPublic',
        value: function sendPublic(publicIndex) {
            var x = this.pokerImg.x;
            var y = this.pokerImg.y + 80;
            switch (publicIndex) {
                case 0:
                    x -= 110;
                    break;
                case 1:
                    x -= 55;
                    break;
                case 2:
                    break;
                case 3:
                    x += 55;
                    break;
                case 4:
                    x += 110;
                    break;
                default:
                    break;
            }
            Laya.Tween.to(this.pokerImg, { x: x, y: y }, 500, Laya.Ease.strongOut, Laya.Handler.create(this, this.sendPublicComplete));
        }
        // 公牌发牌完成

    }, {
        key: 'sendPublicComplete',
        value: function sendPublicComplete() {
            this.pokerImg.skin = 'ui/' + this.dataPoker.card + '.png';
        }
    }]);

    return Poker;
}();

exports.default = Poker;

},{}],4:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _WebSocket = require('../util/WebSocket');

var _WebSocket2 = _interopRequireDefault(_WebSocket);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var Start = function (_Laya$Script) {
    _inherits(Start, _Laya$Script);

    function Start() {
        _classCallCheck(this, Start);

        return _possibleConstructorReturn(this, (Start.__proto__ || Object.getPrototypeOf(Start)).apply(this, arguments));
    }

    _createClass(Start, [{
        key: 'onEnable',
        value: function onEnable() {}
    }, {
        key: 'onClick',
        value: function onClick() {
            _WebSocket2.default.send({ method: 'SEAT_DOWN', user: _WebSocket2.default.globalData.user, seatId: this.owner.name });
            // .then((data) => {
            //     if (data.status == 0) {
            //         // WebSocket.globalData.seats[this.owner.name.slice(4)].seatStatus = 1          // 设置就坐状态
            //         this.owner.skin = `ui/${data.seatInfo.imgUrl}`                               // 设置就坐图片
            //         if (data.seatNum) {
            //             let num = data.seatNum.slice(4)
            //             // WebSocket.globalData.seats[num].seatStatus = 0                           // 设置离开状态
            //             WebSocket.globalData.seats[num].skin = 'ui/head.png'                     // 设置初始图片
            //         }
            //         // 服务器决定是否开始发牌
            //         WebSocket.globalData.isSendCard = data.isSendCard
            //     }
            // })
        }
    }]);

    return Start;
}(Laya.Script);

exports.default = Start;

},{"../util/WebSocket":6}],5:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _WebSocket = require('../util/WebSocket');

var _WebSocket2 = _interopRequireDefault(_WebSocket);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var Start = function (_Laya$Script) {
    _inherits(Start, _Laya$Script);

    function Start() {
        _classCallCheck(this, Start);

        return _possibleConstructorReturn(this, (Start.__proto__ || Object.getPrototypeOf(Start)).apply(this, arguments));
    }

    _createClass(Start, [{
        key: 'onEnable',
        value: function onEnable() {}
    }, {
        key: 'onClick',
        value: function onClick() {
            var userId = 123456;
            _WebSocket2.default.send({ method: 'JOIN_GAME', userId: userId }).then(function (data) {
                if (data.status == 0) {
                    _WebSocket2.default.globalData = { user: data.userInfo };
                    Laya.Scene.open('Game.scene');
                }
            });
        }
    }]);

    return Start;
}(Laya.Script);

exports.default = Start;

},{"../util/WebSocket":6}],6:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/**
 * 网络长连接类
 */
var WebSocket = function () {
    function WebSocket() {
        _classCallCheck(this, WebSocket);

        WebSocket.instance = this;
        // 长连接服务器
        WebSocket.socket = new Laya.Socket();
        WebSocket.socket.endian = Laya.Byte.LITTLE_ENDIAN; //采用小端
    }

    _createClass(WebSocket, [{
        key: 'init',
        value: function init() {
            var _this = this;

            WebSocket.socket.connectByUrl('ws://localhost:4000/socket/poker');
            WebSocket.socket.on(Laya.Event.OPEN, this, function (e) {
                console.log('连接建立');
            });
            WebSocket.socket.on(Laya.Event.CLOSE, this, function (e) {
                console.log('连接关闭');
            });
            WebSocket.socket.on(Laya.Event.ERROR, this, function (e) {
                console.error('连接出错');
            });
            // 封装发送数据方法
            WebSocket.send = function (req) {
                // try {
                return new Promise(function (resolve, reject) {
                    WebSocket.socket.send(JSON.stringify(req));
                    // 返回数据
                    WebSocket.socket.on(Laya.Event.MESSAGE, _this, function (res) {
                        res = JSON.parse(res);
                        if (req.method == res.method) {
                            resolve(res);
                        }
                    });
                });
                // } catch (error) {
                //     setTimeout(() => {
                //         console.log(`重试发送：${data}`)
                //         WebSocket.send(data)
                //     }, 500)
                // }
            };
            WebSocket.socket.on(Laya.Event.MESSAGE, this, function (res) {
                var data = JSON.parse(res);
                if (data.method == 'SEAT_DOWN') {
                    if (data.status == 0) {
                        // WebSocket.globalData.seats[this.owner.name.slice(4)].seatStatus = 1          // 设置就坐状态
                        WebSocket.globalData.seats[data.currentNum].skin = 'ui/' + data.seatInfo.imgUrl; // 设置就坐图片
                        if (data.seatNum) {
                            var num = data.seatNum.slice(4);
                            // WebSocket.globalData.seats[num].seatStatus = 0                           // 设置离开状态
                            WebSocket.globalData.seats[num].skin = 'ui/head.png'; // 设置初始图片
                        }
                        // 服务器决定是否开始发牌
                        WebSocket.globalData.isSendCard = data.isSendCard;
                    }
                }
                if (data.method == 'JOIN_GAME') {
                    if (data.status == 0) {
                        console.log(data.seatArr);
                        if (data.seatArr.length) {
                            var _iteratorNormalCompletion = true;
                            var _didIteratorError = false;
                            var _iteratorError = undefined;

                            try {
                                for (var _iterator = data.seatArr[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
                                    var seatInfo = _step.value;

                                    WebSocket.globalData.seats[seatInfo.seatId].skin = 'ui/' + seatInfo.imgUrl; // 设置就坐图片
                                }
                            } catch (err) {
                                _didIteratorError = true;
                                _iteratorError = err;
                            } finally {
                                try {
                                    if (!_iteratorNormalCompletion && _iterator.return) {
                                        _iterator.return();
                                    }
                                } finally {
                                    if (_didIteratorError) {
                                        throw _iteratorError;
                                    }
                                }
                            }
                        }
                    }
                }
                if (data.method == 'CLOSE') {
                    if (data.status == 0) {
                        WebSocket.globalData.seats[data.userToken.seatId].skin = 'ui/head.png'; // 设置就坐图片   
                    }
                }
            });
        }
    }]);

    return WebSocket;
}();

exports.default = WebSocket;

},{}],7:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _WebSocket = require('../util/WebSocket');

var _WebSocket2 = _interopRequireDefault(_WebSocket);

var _Poker = require('../sprite/Poker');

var _Poker2 = _interopRequireDefault(_Poker);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

/**
 * 游戏主界面类
 * 载入扑克桌
 */
var GameView = function (_Laya$Scene) {
    _inherits(GameView, _Laya$Scene);

    function GameView() {
        _classCallCheck(this, GameView);

        //设置单例的引用方式，方便其他类引用
        var _this = _possibleConstructorReturn(this, (GameView.__proto__ || Object.getPrototypeOf(GameView)).call(this));

        GameView.instance = _this;
        _this.seatCount = 9; // 座位数量    
        _this.seats = []; // 座位数组           
        _this.pokers = []; // 扑克牌数组
        _this.pokerSentIndex = 0; // 已发牌索引
        _this.pokerHandCount = _this.seatCount * 2; // 手牌数量
        _this.pokerCount = _this.pokerHandCount + 5; // 所有牌数量
        _this.chip2Index = 0; // 大盲位索引
        return _this;
    }

    _createClass(GameView, [{
        key: 'onEnable',
        value: function onEnable() {
            // 初始化
            this.init();
        }
    }, {
        key: 'onClosed',
        value: function onClosed() {
            _WebSocket2.default.socket.close();
        }
        // 初始化

    }, {
        key: 'init',
        value: function init() {
            // 初始化桌位
            for (var i = 0; i < this.seatCount; i++) {
                this.seats.push(this.getChildByName('seat' + i));
            }
            _WebSocket2.default.globalData.seats = this.seats;
            // 加载鼠标点击事件
            Laya.stage.on(Laya.Event.MOUSE_DOWN, this, this.onMouseDown);
        }
        // 游戏启动

    }, {
        key: 'gameStart',
        value: function gameStart() {
            // 每人发两张牌
            Laya.timer.loop(300, this, this.onSendPoker); // 每300毫循环一次
            // Laya.timer.frameLoop(10, this, this.onLoop) // 每10帧循环一次
        }
        // 发牌

    }, {
        key: 'onSendPoker',
        value: function onSendPoker() {
            this.pokers[this.pokerSentIndex].send(this.pokerSentIndex);
            this.pokerSentIndex++;
            // 手牌发牌结束
            if (this.pokerSentIndex == this.pokerHandCount) {
                // 隐藏剩余牌，为展开公牌做准备
                // for (let i = this.pokerSentIndex + 1; i <= 22; i++) {
                //     this.pokers[i].hide()
                // }
                Laya.timer.clear(this, this.onSendPoker);
            }
        }

        // 鼠标点击事件

    }, {
        key: 'onMouseDown',
        value: function onMouseDown() {
            var _this2 = this;

            // 每局游戏新开始，并且就坐人数大于2
            if (this.pokerSentIndex == 0 && _WebSocket2.default.globalData.isSendCard) {
                // 初始化牌组
                _WebSocket2.default.send({ method: 'SEND_CARD', count: this.pokerCount }).then(function (data) {
                    for (var i = 0; i < data.pokers.length; i++) {
                        var poker = {};
                        // 手牌
                        if (i < _this2.pokerHandCount) {
                            poker = new _Poker2.default({ pokerImg: _this2.getChildByName('poker' + i), seatImg: _this2.seats[i % _this2.seatCount], dataPoker: data.pokers[i] });
                        }
                        // 公牌
                        else {
                                poker = new _Poker2.default({ pokerImg: _this2.getChildByName('poker' + i), dataPoker: data.pokers[i] });
                            }
                        _this2.pokers.push(poker);
                    }
                    // 启动游戏
                    _this2.gameStart();
                });
            }
            // 发放公共牌
            if (this.pokerSentIndex >= this.pokerHandCount && this.pokerSentIndex < this.pokerCount) {
                Laya.timer.loop(300, this, this.onShowPublicPoker);
            }
            if (this.chip2Index >= this.seats.length) {
                this.chip2Index = 0;
            }
            // 小盲移动到大盲位置
            this.chip1.x = this.chip2.x;
            this.chip1.y = this.chip2.y;
            this.chipText1.x = this.chipText2.x;
            this.chipText1.y = this.chipText2.y;
            // 大盲顺时针移动
            this.chip2.x = this.seats[this.chip2Index].x + 10;
            this.chip2.y = this.seats[this.chip2Index].y - 30;
            this.chipText2.x = this.chip2.x - 10;
            this.chipText2.y = this.chip2.y - 15;
            this.chip2Index++;
        }

        // 展开三张公牌

    }, {
        key: 'onShowPublicPoker',
        value: function onShowPublicPoker() {
            this.pokers[this.pokerSentIndex].sendPublic(this.pokerSentIndex - this.pokerHandCount);
            this.pokerSentIndex++;
            // 发牌行为结束
            if (this.pokerSentIndex >= this.pokerHandCount + 3) {
                Laya.timer.clear(this, this.onShowPublicPoker);
            }
        }
    }]);

    return GameView;
}(Laya.Scene);

exports.default = GameView;

},{"../sprite/Poker":3,"../util/WebSocket":6}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkQ6L0xheWFBaXJJREUvcmVzb3VyY2VzL2FwcC9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwic3JjL0dhbWVDb25maWcuanMiLCJzcmMvTWFpbi5qcyIsInNyYy9zcHJpdGUvUG9rZXIuanMiLCJzcmMvc3ByaXRlL1NlYXQuanMiLCJzcmMvc3ByaXRlL1N0YXJ0LmpzIiwic3JjL3V0aWwvV2ViU29ja2V0LmpzIiwic3JjL3ZpZXcvR2FtZVZpZXcuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztxakJDVkE7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7Ozs7SUFFcUIsVTs7Ozs7OzsrQkFDSDtBQUNWO0FBQ0EsZ0JBQUksTUFBTSxLQUFLLFVBQUwsQ0FBZ0IsUUFBMUI7QUFDTixnQkFBSSxrQkFBSixFQUF1QixrQkFBdkI7QUFDQSxnQkFBSSxnQkFBSixFQUFxQixjQUFyQjtBQUNBLGdCQUFJLGlCQUFKLEVBQXNCLGVBQXRCO0FBQ0c7Ozs7OztrQkFQZ0IsVTs7QUFTckIsV0FBVyxLQUFYLEdBQW1CLEdBQW5CO0FBQ0EsV0FBVyxNQUFYLEdBQW9CLEdBQXBCO0FBQ0EsV0FBVyxTQUFYLEdBQXNCLFNBQXRCO0FBQ0EsV0FBVyxVQUFYLEdBQXdCLE1BQXhCO0FBQ0EsV0FBVyxNQUFYLEdBQW9CLFFBQXBCO0FBQ0EsV0FBVyxNQUFYLEdBQW9CLFFBQXBCO0FBQ0EsV0FBVyxVQUFYLEdBQXdCLGFBQXhCO0FBQ0EsV0FBVyxTQUFYLEdBQXVCLEVBQXZCO0FBQ0EsV0FBVyxLQUFYLEdBQW1CLEtBQW5CO0FBQ0EsV0FBVyxJQUFYLEdBQWtCLEtBQWxCO0FBQ0EsV0FBVyxZQUFYLEdBQTBCLEtBQTFCO0FBQ0EsV0FBVyxpQkFBWCxHQUErQixJQUEvQjs7QUFFQSxXQUFXLElBQVg7Ozs7Ozs7QUMzQkE7Ozs7QUFDQTs7Ozs7Ozs7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LFVBQWpDLENBQTRDLEtBQUssY0FBTCxHQUFzQixLQUFLLGNBQXZFO0FBQ0EsaUJBQUssY0FBTDtBQUNBO0FBQ0EsZ0JBQUksS0FBSyxjQUFMLElBQXVCLEtBQUssY0FBTCxHQUFzQixDQUFqRCxFQUFvRDtBQUNoRCxxQkFBSyxLQUFMLENBQVcsS0FBWCxDQUFpQixJQUFqQixFQUF1QixLQUFLLGlCQUE1QjtBQUNIO0FBQ0o7Ozs7RUFwR2lDLEtBQUssSzs7a0JBQXRCLFEiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XHJcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbiAgICB9O1xyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiLyoqVGhpcyBjbGFzcyBpcyBhdXRvbWF0aWNhbGx5IGdlbmVyYXRlZCBieSBMYXlhQWlySURFLCBwbGVhc2UgZG8gbm90IG1ha2UgYW55IG1vZGlmaWNhdGlvbnMuICovXHJcbmltcG9ydCBHYW1lVmlldyBmcm9tIFwiLi92aWV3L0dhbWVWaWV3XCJcbmltcG9ydCBTZWF0IGZyb20gXCIuL3Nwcml0ZS9TZWF0XCJcbmltcG9ydCBTdGFydCBmcm9tIFwiLi9zcHJpdGUvU3RhcnRcIlxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZUNvbmZpZyB7XHJcbiAgICBzdGF0aWMgaW5pdCgpIHtcclxuICAgICAgICAvL+azqOWGjFNjcmlwdOaIluiAhVJ1bnRpbWXlvJXnlKhcclxuICAgICAgICBsZXQgcmVnID0gTGF5YS5DbGFzc1V0aWxzLnJlZ0NsYXNzO1xyXG5cdFx0cmVnKFwidmlldy9HYW1lVmlldy5qc1wiLEdhbWVWaWV3KTtcblx0XHRyZWcoXCJzcHJpdGUvU2VhdC5qc1wiLFNlYXQpO1xuXHRcdHJlZyhcInNwcml0ZS9TdGFydC5qc1wiLFN0YXJ0KTtcclxuICAgIH1cclxufVxyXG5HYW1lQ29uZmlnLndpZHRoID0gMzcwO1xyXG5HYW1lQ29uZmlnLmhlaWdodCA9IDY1ODtcclxuR2FtZUNvbmZpZy5zY2FsZU1vZGUgPVwic2hvd2FsbFwiO1xyXG5HYW1lQ29uZmlnLnNjcmVlbk1vZGUgPSBcIm5vbmVcIjtcclxuR2FtZUNvbmZpZy5hbGlnblYgPSBcIm1pZGRsZVwiO1xyXG5HYW1lQ29uZmlnLmFsaWduSCA9IFwiY2VudGVyXCI7XHJcbkdhbWVDb25maWcuc3RhcnRTY2VuZSA9IFwiU3RhcnQuc2NlbmVcIjtcclxuR2FtZUNvbmZpZy5zY2VuZVJvb3QgPSBcIlwiO1xyXG5HYW1lQ29uZmlnLmRlYnVnID0gZmFsc2U7XHJcbkdhbWVDb25maWcuc3RhdCA9IGZhbHNlO1xyXG5HYW1lQ29uZmlnLnBoeXNpY3NEZWJ1ZyA9IGZhbHNlO1xyXG5HYW1lQ29uZmlnLmV4cG9ydFNjZW5lVG9Kc29uID0gdHJ1ZTtcclxuXHJcbkdhbWVDb25maWcuaW5pdCgpO1xyXG4iLCJpbXBvcnQgR2FtZUNvbmZpZyBmcm9tICcuL0dhbWVDb25maWcnXHJcbmltcG9ydCBXZWJTb2NrZXQgZnJvbSAnLi91dGlsL1dlYlNvY2tldCdcclxuXHJcbmNsYXNzIE1haW4ge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgLy/moLnmja5JREXorr7nva7liJ3lp4vljJblvJXmk45cclxuICAgICAgICBpZiAod2luZG93W1wiTGF5YTNEXCJdKSBMYXlhM0QuaW5pdChHYW1lQ29uZmlnLndpZHRoLCBHYW1lQ29uZmlnLmhlaWdodCk7XHJcbiAgICAgICAgZWxzZSBMYXlhLmluaXQoR2FtZUNvbmZpZy53aWR0aCwgR2FtZUNvbmZpZy5oZWlnaHQsIExheWFbXCJXZWJHTFwiXSk7XHJcbiAgICAgICAgTGF5YVtcIlBoeXNpY3NcIl0gJiYgTGF5YVtcIlBoeXNpY3NcIl0uZW5hYmxlKCk7XHJcbiAgICAgICAgTGF5YVtcIkRlYnVnUGFuZWxcIl0gJiYgTGF5YVtcIkRlYnVnUGFuZWxcIl0uZW5hYmxlKCk7XHJcbiAgICAgICAgTGF5YS5zdGFnZS5zY2FsZU1vZGUgPSBHYW1lQ29uZmlnLnNjYWxlTW9kZTtcclxuICAgICAgICBMYXlhLnN0YWdlLnNjcmVlbk1vZGUgPSBHYW1lQ29uZmlnLnNjcmVlbk1vZGU7XHJcbiAgICAgICAgTGF5YS5zdGFnZS5hbGlnblYgPSBHYW1lQ29uZmlnLmFsaWduVjtcclxuICAgICAgICBMYXlhLnN0YWdlLmFsaWduSCA9IEdhbWVDb25maWcuYWxpZ25IO1xyXG4gICAgICAgIC8v5YW85a655b6u5L+h5LiN5pSv5oyB5Yqg6L29c2NlbmXlkI7nvIDlnLrmma9cclxuICAgICAgICBMYXlhLlVSTC5leHBvcnRTY2VuZVRvSnNvbiA9IEdhbWVDb25maWcuZXhwb3J0U2NlbmVUb0pzb25cclxuXHJcbiAgICAgICAgLy/miZPlvIDosIPor5XpnaLmnb/vvIjpgJrov4dJREXorr7nva7osIPor5XmqKHlvI/vvIzmiJbogIV1cmzlnLDlnYDlop7liqBkZWJ1Zz10cnVl5Y+C5pWw77yM5Z2H5Y+v5omT5byA6LCD6K+V6Z2i5p2/77yJXHJcbiAgICAgICAgaWYgKEdhbWVDb25maWcuZGVidWcgfHwgTGF5YS5VdGlscy5nZXRRdWVyeVN0cmluZyhcImRlYnVnXCIpID09IFwidHJ1ZVwiKSBMYXlhLmVuYWJsZURlYnVnUGFuZWwoKTtcclxuICAgICAgICBpZiAoR2FtZUNvbmZpZy5waHlzaWNzRGVidWcgJiYgTGF5YVtcIlBoeXNpY3NEZWJ1Z0RyYXdcIl0pIExheWFbXCJQaHlzaWNzRGVidWdEcmF3XCJdLmVuYWJsZSgpO1xyXG4gICAgICAgIGlmIChHYW1lQ29uZmlnLnN0YXQpIExheWEuU3RhdC5zaG93KCk7XHJcbiAgICAgICAgTGF5YS5hbGVydEdsb2JhbEVycm9yID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgLy/mv4DmtLvotYTmupDniYjmnKzmjqfliLbvvIx2ZXJzaW9uLmpzb27nlLFJREXlj5HluIPlip/og73oh6rliqjnlJ/miJDvvIzlpoLmnpzmsqHmnInkuZ/kuI3lvbHlk43lkI7nu63mtYHnqItcclxuICAgICAgICBMYXlhLlJlc291cmNlVmVyc2lvbi5lbmFibGUoXCJ2ZXJzaW9uLmpzb25cIiwgTGF5YS5IYW5kbGVyLmNyZWF0ZSh0aGlzLCB0aGlzLm9uVmVyc2lvbkxvYWRlZCksIExheWEuUmVzb3VyY2VWZXJzaW9uLkZJTEVOQU1FX1ZFUlNJT04pXHJcbiAgICAgICAgLy/liqDovb3nvZHnu5zov57mjqVcclxuICAgICAgICBuZXcgV2ViU29ja2V0KCkuaW5pdCgpXHJcbiAgICB9XHJcbiAgICBvblZlcnNpb25Mb2FkZWQoKSB7XHJcbiAgICAgICAgLy/mv4DmtLvlpKflsI/lm77mmKDlsITvvIzliqDovb3lsI/lm77nmoTml7blgJnvvIzlpoLmnpzlj5HnjrDlsI/lm77lnKjlpKflm77lkIjpm4bph4zpnaLvvIzliJnkvJjlhYjliqDovb3lpKflm77lkIjpm4bvvIzogIzkuI3mmK/lsI/lm75cclxuICAgICAgICBMYXlhLkF0bGFzSW5mb01hbmFnZXIuZW5hYmxlKFwiZmlsZWNvbmZpZy5qc29uXCIsIExheWEuSGFuZGxlci5jcmVhdGUodGhpcywgdGhpcy5vbkNvbmZpZ0xvYWRlZCkpXHJcbiAgICB9XHJcbiAgICBvbkNvbmZpZ0xvYWRlZCgpIHtcclxuICAgICAgICAvL+WKoOi9vUlEReaMh+WumueahOWcuuaZr1xyXG4gICAgICAgIEdhbWVDb25maWcuc3RhcnRTY2VuZSAmJiBMYXlhLlNjZW5lLm9wZW4oR2FtZUNvbmZpZy5zdGFydFNjZW5lKVxyXG4gICAgICAgIC8vIGJlZ2luTG9hZCgpXHJcbiAgICB9XHJcbiAgICAvLyAvLyDliqDovb3otYTmupBcclxuICAgIC8vIGJlZ2luTG9hZCgpIHtcclxuICAgIC8vICAgICAvLyDliqDovb3lm77pm4ZcclxuICAgIC8vICAgICBMYXlhLmxvYWRlci5sb2FkKFwicmVzL2F0bGFzL3VpLmF0bGFzXCIsIExheWEuSGFuZGxlci5jcmVhdGUodGhpcywgdGhpcy5vbkxvYWRlZCksIG51bGwsIExheWEuTG9hZGVyLkFUTEFTKVxyXG4gICAgLy8gICAgIC8vIOaSreaUvuiDjOaZr+mfs+S5kFxyXG4gICAgLy8gICAgIC8vIExheWEuU291bmRNYW5hZ2VyLnBsYXlNdXNpYyhcInJlcy9zb3VuZHMvYmdtLm1wM1wiLCAwLCBudWxsKVxyXG4gICAgLy8gfVxyXG4gICAgLy8gLy8g5Yqg6L295a6M5oiQ5Zue6LCDXHJcbiAgICAvLyBvbkxvYWRlZCgpIHtcclxuICAgIC8vICAgICAvLyDlkK/liqjmuLjmiI/nlYzpnaJcclxuICAgIC8vICAgICBMYXlhQXBwLmdhbWVWaWV3ID0gbmV3IEdhbWVWaWV3KClcclxuICAgIC8vICAgICBMYXlhLnN0YWdlLmFkZENoaWxkKExheWFBcHAuZ2FtZVZpZXcpXHJcbiAgICAvLyAgICAgLy8gTGF5YUFwcC5nYW1lU3RhcnRWaWV3ID0gbmV3IEdhbWVTdGFydFZpZXcoKVxyXG4gICAgLy8gICAgIC8vIExheWEuc3RhZ2UuYWRkQ2hpbGQoTGF5YUFwcC5nYW1lU3RhcnRWaWV3KVxyXG4gICAgLy8gfVxyXG59XHJcblxyXG4vL+a/gOa0u+WQr+WKqOexu1xyXG5uZXcgTWFpbigpXHJcblxyXG4iLCIvKipcclxuICog5omR5YWL57G7XHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb2tlciB7XHJcbiAgICBjb25zdHJ1Y3RvcihpbnBhcmFtKSB7XHJcbiAgICAgICAgdGhpcy5wb2tlckltZyA9IGlucGFyYW0ucG9rZXJJbWdcclxuICAgICAgICB0aGlzLnNlYXRJbWcgPSBpbnBhcmFtLnNlYXRJbWdcclxuICAgICAgICB0aGlzLmRhdGFQb2tlciA9IGlucGFyYW0uZGF0YVBva2VyXHJcbiAgICAgICAgdGhpcy5pc01lID0gZmFsc2VcclxuICAgICAgICAvLyB0aGlzLnJlc2V0KClcclxuICAgIH1cclxuICAgIC8vIOmHjee9rlxyXG4gICAgcmVzZXQoKSB7XHJcbiAgICB9XHJcbiAgICAvLyDpmpDol49cclxuICAgIGhpZGUoKSB7XHJcbiAgICAgICAgdGhpcy5wb2tlckltZy52aXNpYmxlID0gZmFsc2VcclxuICAgIH1cclxuICAgIC8vIOWPkeeJjFxyXG4gICAgc2VuZChwb2tlclNlbnRJbmRleCkge1xyXG4gICAgICAgIHRoaXMuaXNNZSA9IHRoaXMuc2VhdEltZy5uYW1lID09ICdzZWF0MCcgPyB0cnVlIDogZmFsc2VcclxuICAgICAgICBsZXQgeCA9IHRoaXMuc2VhdEltZy54XHJcbiAgICAgICAgaWYgKHRoaXMuaXNNZSkge1xyXG4gICAgICAgICAgICBwb2tlclNlbnRJbmRleCA9PSAwID8geCArPSA1MCA6IHggKz0gMTAwXHJcbiAgICAgICAgfVxyXG4gICAgICAgIExheWEuVHdlZW4udG8odGhpcy5wb2tlckltZywgeyB4LCB5OiB0aGlzLnNlYXRJbWcueSB9LCA1MDAsIExheWEuRWFzZS5zdHJvbmdPdXQsIExheWEuSGFuZGxlci5jcmVhdGUodGhpcywgdGhpcy5zZW5kQ29tcGxldGUpKVxyXG4gICAgfVxyXG4gICAgLy8g5omL54mM5Y+R54mM5a6M5oiQXHJcbiAgICBzZW5kQ29tcGxldGUoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzTWUpIHtcclxuICAgICAgICAgICAgdGhpcy5wb2tlckltZy52aXNpYmxlID0gZmFsc2VcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnBva2VySW1nLnNraW4gPSBgdWkvJHt0aGlzLmRhdGFQb2tlci5jYXJkfS5wbmdgXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8g5Y+R5YWs5YWx54mMXHJcbiAgICBzZW5kUHVibGljKHB1YmxpY0luZGV4KSB7XHJcbiAgICAgICAgbGV0IHggPSB0aGlzLnBva2VySW1nLnhcclxuICAgICAgICBsZXQgeSA9IHRoaXMucG9rZXJJbWcueSArIDgwXHJcbiAgICAgICAgc3dpdGNoIChwdWJsaWNJbmRleCkge1xyXG4gICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICB4IC09IDExMFxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgIHggLT0gNTVcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgeCArPSA1NVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgIHggKz0gMTEwXHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBMYXlhLlR3ZWVuLnRvKHRoaXMucG9rZXJJbWcsIHsgeCwgeSB9LCA1MDAsIExheWEuRWFzZS5zdHJvbmdPdXQsIExheWEuSGFuZGxlci5jcmVhdGUodGhpcywgdGhpcy5zZW5kUHVibGljQ29tcGxldGUpKVxyXG4gICAgfVxyXG4gICAgLy8g5YWs54mM5Y+R54mM5a6M5oiQXHJcbiAgICBzZW5kUHVibGljQ29tcGxldGUoKSB7XHJcbiAgICAgICAgdGhpcy5wb2tlckltZy5za2luID0gYHVpLyR7dGhpcy5kYXRhUG9rZXIuY2FyZH0ucG5nYFxyXG4gICAgfVxyXG59IiwiaW1wb3J0IFdlYlNvY2tldCBmcm9tICcuLi91dGlsL1dlYlNvY2tldCdcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFN0YXJ0IGV4dGVuZHMgTGF5YS5TY3JpcHQge1xyXG4gICAgb25FbmFibGUoKSB7XHJcbiAgICB9XHJcbiAgICBvbkNsaWNrKCkge1xyXG4gICAgICAgIFdlYlNvY2tldC5zZW5kKHsgbWV0aG9kOiAnU0VBVF9ET1dOJywgdXNlcjogV2ViU29ja2V0Lmdsb2JhbERhdGEudXNlciwgc2VhdElkOiB0aGlzLm93bmVyLm5hbWUgfSlcclxuICAgICAgICAvLyAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgIC8vICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gMCkge1xyXG4gICAgICAgIC8vICAgICAgICAgLy8gV2ViU29ja2V0Lmdsb2JhbERhdGEuc2VhdHNbdGhpcy5vd25lci5uYW1lLnNsaWNlKDQpXS5zZWF0U3RhdHVzID0gMSAgICAgICAgICAvLyDorr7nva7lsLHlnZDnirbmgIFcclxuICAgICAgICAvLyAgICAgICAgIHRoaXMub3duZXIuc2tpbiA9IGB1aS8ke2RhdGEuc2VhdEluZm8uaW1nVXJsfWAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6K6+572u5bCx5Z2Q5Zu+54mHXHJcbiAgICAgICAgLy8gICAgICAgICBpZiAoZGF0YS5zZWF0TnVtKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgbGV0IG51bSA9IGRhdGEuc2VhdE51bS5zbGljZSg0KVxyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vIFdlYlNvY2tldC5nbG9iYWxEYXRhLnNlYXRzW251bV0uc2VhdFN0YXR1cyA9IDAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDorr7nva7nprvlvIDnirbmgIFcclxuICAgICAgICAvLyAgICAgICAgICAgICBXZWJTb2NrZXQuZ2xvYmFsRGF0YS5zZWF0c1tudW1dLnNraW4gPSAndWkvaGVhZC5wbmcnICAgICAgICAgICAgICAgICAgICAgLy8g6K6+572u5Yid5aeL5Zu+54mHXHJcbiAgICAgICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgICAgICAvLyDmnI3liqHlmajlhrPlrprmmK/lkKblvIDlp4vlj5HniYxcclxuICAgICAgICAvLyAgICAgICAgIFdlYlNvY2tldC5nbG9iYWxEYXRhLmlzU2VuZENhcmQgPSBkYXRhLmlzU2VuZENhcmRcclxuICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgIC8vIH0pXHJcblxyXG4gICAgfVxyXG59IiwiaW1wb3J0IFdlYlNvY2tldCBmcm9tICcuLi91dGlsL1dlYlNvY2tldCdcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFN0YXJ0IGV4dGVuZHMgTGF5YS5TY3JpcHQge1xyXG4gICAgb25FbmFibGUoKSB7XHJcblxyXG4gICAgfVxyXG4gICAgb25DbGljaygpIHtcclxuICAgICAgICBsZXQgdXNlcklkID0gMTIzNDU2XHJcbiAgICAgICAgV2ViU29ja2V0LnNlbmQoeyBtZXRob2Q6ICdKT0lOX0dBTUUnLCB1c2VySWQgfSkudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgV2ViU29ja2V0Lmdsb2JhbERhdGEgPSB7IHVzZXI6IGRhdGEudXNlckluZm8gfVxyXG4gICAgICAgICAgICAgICAgTGF5YS5TY2VuZS5vcGVuKCdHYW1lLnNjZW5lJylcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbn0iLCIvKipcclxuICog572R57uc6ZW/6L+e5o6l57G7XHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBXZWJTb2NrZXQge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgV2ViU29ja2V0Lmluc3RhbmNlID0gdGhpc1xyXG4gICAgICAgIC8vIOmVv+i/nuaOpeacjeWKoeWZqFxyXG4gICAgICAgIFdlYlNvY2tldC5zb2NrZXQgPSBuZXcgTGF5YS5Tb2NrZXQoKVxyXG4gICAgICAgIFdlYlNvY2tldC5zb2NrZXQuZW5kaWFuID0gTGF5YS5CeXRlLkxJVFRMRV9FTkRJQU4vL+mHh+eUqOWwj+err1xyXG4gICAgfVxyXG4gICAgaW5pdCgpIHtcclxuICAgICAgICBXZWJTb2NrZXQuc29ja2V0LmNvbm5lY3RCeVVybCgnd3M6Ly9sb2NhbGhvc3Q6NDAwMC9zb2NrZXQvcG9rZXInKVxyXG4gICAgICAgIFdlYlNvY2tldC5zb2NrZXQub24oTGF5YS5FdmVudC5PUEVOLCB0aGlzLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygn6L+e5o6l5bu656uLJylcclxuICAgICAgICB9KVxyXG4gICAgICAgIFdlYlNvY2tldC5zb2NrZXQub24oTGF5YS5FdmVudC5DTE9TRSwgdGhpcywgKGUpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ+i/nuaOpeWFs+mXrScpXHJcbiAgICAgICAgfSlcclxuICAgICAgICBXZWJTb2NrZXQuc29ja2V0Lm9uKExheWEuRXZlbnQuRVJST1IsIHRoaXMsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+i/nuaOpeWHuumUmScpXHJcbiAgICAgICAgfSlcclxuICAgICAgICAvLyDlsIHoo4Xlj5HpgIHmlbDmja7mlrnms5VcclxuICAgICAgICBXZWJTb2NrZXQuc2VuZCA9IChyZXEpID0+IHtcclxuICAgICAgICAgICAgLy8gdHJ5IHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgICAgIFdlYlNvY2tldC5zb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeShyZXEpKVxyXG4gICAgICAgICAgICAgICAgLy8g6L+U5Zue5pWw5o2uXHJcbiAgICAgICAgICAgICAgICBXZWJTb2NrZXQuc29ja2V0Lm9uKExheWEuRXZlbnQuTUVTU0FHRSwgdGhpcywgKHJlcykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcyA9IEpTT04ucGFyc2UocmVzKVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXEubWV0aG9kID09IHJlcy5tZXRob2QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLy8gfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgLy8gICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIGNvbnNvbGUubG9nKGDph43or5Xlj5HpgIHvvJoke2RhdGF9YClcclxuICAgICAgICAgICAgLy8gICAgICAgICBXZWJTb2NrZXQuc2VuZChkYXRhKVxyXG4gICAgICAgICAgICAvLyAgICAgfSwgNTAwKVxyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFdlYlNvY2tldC5zb2NrZXQub24oTGF5YS5FdmVudC5NRVNTQUdFLCB0aGlzLCAocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBkYXRhID0gSlNPTi5wYXJzZShyZXMpXHJcbiAgICAgICAgICAgIGlmIChkYXRhLm1ldGhvZCA9PSAnU0VBVF9ET1dOJykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBXZWJTb2NrZXQuZ2xvYmFsRGF0YS5zZWF0c1t0aGlzLm93bmVyLm5hbWUuc2xpY2UoNCldLnNlYXRTdGF0dXMgPSAxICAgICAgICAgIC8vIOiuvue9ruWwseWdkOeKtuaAgVxyXG4gICAgICAgICAgICAgICAgICAgIFdlYlNvY2tldC5nbG9iYWxEYXRhLnNlYXRzW2RhdGEuY3VycmVudE51bV0uc2tpbiA9IGB1aS8ke2RhdGEuc2VhdEluZm8uaW1nVXJsfWAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6K6+572u5bCx5Z2Q5Zu+54mHXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc2VhdE51bSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbnVtID0gZGF0YS5zZWF0TnVtLnNsaWNlKDQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdlYlNvY2tldC5nbG9iYWxEYXRhLnNlYXRzW251bV0uc2VhdFN0YXR1cyA9IDAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDorr7nva7nprvlvIDnirbmgIFcclxuICAgICAgICAgICAgICAgICAgICAgICAgV2ViU29ja2V0Lmdsb2JhbERhdGEuc2VhdHNbbnVtXS5za2luID0gJ3VpL2hlYWQucG5nJyAgICAgICAgICAgICAgICAgICAgIC8vIOiuvue9ruWIneWni+WbvueJh1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyDmnI3liqHlmajlhrPlrprmmK/lkKblvIDlp4vlj5HniYxcclxuICAgICAgICAgICAgICAgICAgICBXZWJTb2NrZXQuZ2xvYmFsRGF0YS5pc1NlbmRDYXJkID0gZGF0YS5pc1NlbmRDYXJkXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGRhdGEubWV0aG9kID09ICdKT0lOX0dBTUUnKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEuc2VhdEFycilcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zZWF0QXJyLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBzZWF0SW5mbyBvZiBkYXRhLnNlYXRBcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFdlYlNvY2tldC5nbG9iYWxEYXRhLnNlYXRzW3NlYXRJbmZvLnNlYXRJZF0uc2tpbiA9IGB1aS8ke3NlYXRJbmZvLmltZ1VybH1gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiuvue9ruWwseWdkOWbvueJh1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChkYXRhLm1ldGhvZCA9PSAnQ0xPU0UnKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIFdlYlNvY2tldC5nbG9iYWxEYXRhLnNlYXRzW2RhdGEudXNlclRva2VuLnNlYXRJZF0uc2tpbiA9IGB1aS9oZWFkLnBuZ2AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6K6+572u5bCx5Z2Q5Zu+54mHICAgXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfVxyXG59IiwiaW1wb3J0IFdlYlNvY2tldCBmcm9tICcuLi91dGlsL1dlYlNvY2tldCdcclxuaW1wb3J0IFBva2VyIGZyb20gJy4uL3Nwcml0ZS9Qb2tlcidcclxuXHJcbi8qKlxyXG4gKiDmuLjmiI/kuLvnlYzpnaLnsbtcclxuICog6L295YWl5omR5YWL5qGMXHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lVmlldyBleHRlbmRzIExheWEuU2NlbmUge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKVxyXG4gICAgICAgIC8v6K6+572u5Y2V5L6L55qE5byV55So5pa55byP77yM5pa55L6/5YW25LuW57G75byV55SoXHJcbiAgICAgICAgR2FtZVZpZXcuaW5zdGFuY2UgPSB0aGlzXHJcbiAgICAgICAgdGhpcy5zZWF0Q291bnQgPSA5ICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDluqfkvY3mlbDph48gICAgXHJcbiAgICAgICAgdGhpcy5zZWF0cyA9IFtdICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDluqfkvY3mlbDnu4QgICAgICAgICAgIFxyXG4gICAgICAgIHRoaXMucG9rZXJzID0gW10gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5omR5YWL54mM5pWw57uEXHJcbiAgICAgICAgdGhpcy5wb2tlclNlbnRJbmRleCA9IDAgICAgICAgICAgICAgICAgICAgICAvLyDlt7Llj5HniYzntKLlvJVcclxuICAgICAgICB0aGlzLnBva2VySGFuZENvdW50ID0gdGhpcy5zZWF0Q291bnQgKiAyICAgIC8vIOaJi+eJjOaVsOmHj1xyXG4gICAgICAgIHRoaXMucG9rZXJDb3VudCA9IHRoaXMucG9rZXJIYW5kQ291bnQgKyA1ICAgLy8g5omA5pyJ54mM5pWw6YePXHJcbiAgICAgICAgdGhpcy5jaGlwMkluZGV4ID0gMCAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlpKfnm7LkvY3ntKLlvJVcclxuICAgIH1cclxuICAgIG9uRW5hYmxlKCkge1xyXG4gICAgICAgIC8vIOWIneWni+WMllxyXG4gICAgICAgIHRoaXMuaW5pdCgpXHJcbiAgICB9XHJcbiAgICBvbkNsb3NlZCgpIHtcclxuICAgICAgICBXZWJTb2NrZXQuc29ja2V0LmNsb3NlKClcclxuICAgIH1cclxuICAgIC8vIOWIneWni+WMllxyXG4gICAgaW5pdCgpIHtcclxuICAgICAgICAvLyDliJ3lp4vljJbmoYzkvY1cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc2VhdENvdW50OyBpKyspIHtcclxuICAgICAgICAgICAgdGhpcy5zZWF0cy5wdXNoKHRoaXMuZ2V0Q2hpbGRCeU5hbWUoYHNlYXQke2l9YCkpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFdlYlNvY2tldC5nbG9iYWxEYXRhLnNlYXRzID0gdGhpcy5zZWF0c1xyXG4gICAgICAgIC8vIOWKoOi9vem8oOagh+eCueWHu+S6i+S7tlxyXG4gICAgICAgIExheWEuc3RhZ2Uub24oTGF5YS5FdmVudC5NT1VTRV9ET1dOLCB0aGlzLCB0aGlzLm9uTW91c2VEb3duKVxyXG4gICAgfVxyXG4gICAgLy8g5ri45oiP5ZCv5YqoXHJcbiAgICBnYW1lU3RhcnQoKSB7XHJcbiAgICAgICAgLy8g5q+P5Lq65Y+R5Lik5byg54mMXHJcbiAgICAgICAgTGF5YS50aW1lci5sb29wKDMwMCwgdGhpcywgdGhpcy5vblNlbmRQb2tlcikgIC8vIOavjzMwMOavq+W+queOr+S4gOasoVxyXG4gICAgICAgIC8vIExheWEudGltZXIuZnJhbWVMb29wKDEwLCB0aGlzLCB0aGlzLm9uTG9vcCkgLy8g5q+PMTDluKflvqrnjq/kuIDmrKFcclxuICAgIH1cclxuICAgIC8vIOWPkeeJjFxyXG4gICAgb25TZW5kUG9rZXIoKSB7XHJcbiAgICAgICAgdGhpcy5wb2tlcnNbdGhpcy5wb2tlclNlbnRJbmRleF0uc2VuZCh0aGlzLnBva2VyU2VudEluZGV4KVxyXG4gICAgICAgIHRoaXMucG9rZXJTZW50SW5kZXgrK1xyXG4gICAgICAgIC8vIOaJi+eJjOWPkeeJjOe7k+adn1xyXG4gICAgICAgIGlmICh0aGlzLnBva2VyU2VudEluZGV4ID09IHRoaXMucG9rZXJIYW5kQ291bnQpIHtcclxuICAgICAgICAgICAgLy8g6ZqQ6JeP5Ymp5L2Z54mM77yM5Li65bGV5byA5YWs54mM5YGa5YeG5aSHXHJcbiAgICAgICAgICAgIC8vIGZvciAobGV0IGkgPSB0aGlzLnBva2VyU2VudEluZGV4ICsgMTsgaSA8PSAyMjsgaSsrKSB7XHJcbiAgICAgICAgICAgIC8vICAgICB0aGlzLnBva2Vyc1tpXS5oaWRlKClcclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICBMYXlhLnRpbWVyLmNsZWFyKHRoaXMsIHRoaXMub25TZW5kUG9rZXIpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOm8oOagh+eCueWHu+S6i+S7tlxyXG4gICAgb25Nb3VzZURvd24oKSB7XHJcbiAgICAgICAgLy8g5q+P5bGA5ri45oiP5paw5byA5aeL77yM5bm25LiU5bCx5Z2Q5Lq65pWw5aSn5LqOMlxyXG4gICAgICAgIGlmICh0aGlzLnBva2VyU2VudEluZGV4ID09IDAgJiYgV2ViU29ja2V0Lmdsb2JhbERhdGEuaXNTZW5kQ2FyZCkge1xyXG4gICAgICAgICAgICAvLyDliJ3lp4vljJbniYznu4RcclxuICAgICAgICAgICAgV2ViU29ja2V0LnNlbmQoeyBtZXRob2Q6ICdTRU5EX0NBUkQnLCBjb3VudDogdGhpcy5wb2tlckNvdW50IH0pLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5wb2tlcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgcG9rZXIgPSB7fVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIOaJi+eJjFxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpIDwgdGhpcy5wb2tlckhhbmRDb3VudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb2tlciA9IG5ldyBQb2tlcih7IHBva2VySW1nOiB0aGlzLmdldENoaWxkQnlOYW1lKGBwb2tlciR7aX1gKSwgc2VhdEltZzogdGhpcy5zZWF0c1tpICUgdGhpcy5zZWF0Q291bnRdLCBkYXRhUG9rZXI6IGRhdGEucG9rZXJzW2ldIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIOWFrOeJjFxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb2tlciA9IG5ldyBQb2tlcih7IHBva2VySW1nOiB0aGlzLmdldENoaWxkQnlOYW1lKGBwb2tlciR7aX1gKSwgZGF0YVBva2VyOiBkYXRhLnBva2Vyc1tpXSB9KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBva2Vycy5wdXNoKHBva2VyKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8g5ZCv5Yqo5ri45oiPXHJcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWVTdGFydCgpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOWPkeaUvuWFrOWFseeJjFxyXG4gICAgICAgIGlmICh0aGlzLnBva2VyU2VudEluZGV4ID49IHRoaXMucG9rZXJIYW5kQ291bnQgJiYgdGhpcy5wb2tlclNlbnRJbmRleCA8IHRoaXMucG9rZXJDb3VudCkge1xyXG4gICAgICAgICAgICBMYXlhLnRpbWVyLmxvb3AoMzAwLCB0aGlzLCB0aGlzLm9uU2hvd1B1YmxpY1Bva2VyKVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5jaGlwMkluZGV4ID49IHRoaXMuc2VhdHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpcDJJbmRleCA9IDBcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5bCP55uy56e75Yqo5Yiw5aSn55uy5L2N572uXHJcbiAgICAgICAgdGhpcy5jaGlwMS54ID0gdGhpcy5jaGlwMi54XHJcbiAgICAgICAgdGhpcy5jaGlwMS55ID0gdGhpcy5jaGlwMi55XHJcbiAgICAgICAgdGhpcy5jaGlwVGV4dDEueCA9IHRoaXMuY2hpcFRleHQyLnhcclxuICAgICAgICB0aGlzLmNoaXBUZXh0MS55ID0gdGhpcy5jaGlwVGV4dDIueVxyXG4gICAgICAgIC8vIOWkp+ebsumhuuaXtumSiOenu+WKqFxyXG4gICAgICAgIHRoaXMuY2hpcDIueCA9IHRoaXMuc2VhdHNbdGhpcy5jaGlwMkluZGV4XS54ICsgMTBcclxuICAgICAgICB0aGlzLmNoaXAyLnkgPSB0aGlzLnNlYXRzW3RoaXMuY2hpcDJJbmRleF0ueSAtIDMwXHJcbiAgICAgICAgdGhpcy5jaGlwVGV4dDIueCA9IHRoaXMuY2hpcDIueCAtIDEwXHJcbiAgICAgICAgdGhpcy5jaGlwVGV4dDIueSA9IHRoaXMuY2hpcDIueSAtIDE1XHJcbiAgICAgICAgdGhpcy5jaGlwMkluZGV4KytcclxuICAgIH1cclxuXHJcbiAgICAvLyDlsZXlvIDkuInlvKDlhazniYxcclxuICAgIG9uU2hvd1B1YmxpY1Bva2VyKCkge1xyXG4gICAgICAgIHRoaXMucG9rZXJzW3RoaXMucG9rZXJTZW50SW5kZXhdLnNlbmRQdWJsaWModGhpcy5wb2tlclNlbnRJbmRleCAtIHRoaXMucG9rZXJIYW5kQ291bnQpXHJcbiAgICAgICAgdGhpcy5wb2tlclNlbnRJbmRleCsrXHJcbiAgICAgICAgLy8g5Y+R54mM6KGM5Li657uT5p2fXHJcbiAgICAgICAgaWYgKHRoaXMucG9rZXJTZW50SW5kZXggPj0gdGhpcy5wb2tlckhhbmRDb3VudCArIDMpIHtcclxuICAgICAgICAgICAgTGF5YS50aW1lci5jbGVhcih0aGlzLCB0aGlzLm9uU2hvd1B1YmxpY1Bva2VyKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSJdfQ==
